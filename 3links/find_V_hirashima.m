function V_hirashima = find_V_hirashima(I1x,I2x,I3x,I1y,I2y,I3y,I1z,I2z,I3z,l1,l2,lg1,lg2,lg3,m1,m2,m3,omega1_1,omega1_2,omega1_3,omega2_1,omega2_2,omega2_3,omega3_1,omega3_2,omega3_3,seg1_top_a_1,seg1_top_a_2,seg1_top_a_3,theta1_1,theta1_2,theta1_3,theta2_1,theta2_2,theta2_3,theta3_1,theta3_2,theta3_3)
%find_V_hirashima
%    V_hirashima = find_V_hirashima(I1x,I2x,I3x,I1y,I2y,I3y,I1z,I2z,I3z,L1,L2,LG1,LG2,LG3,M1,M2,M3,OMEGA1_1,OMEGA1_2,OMEGA1_3,OMEGA2_1,OMEGA2_2,OMEGA2_3,OMEGA3_1,OMEGA3_2,OMEGA3_3,SEG1_TOP_A_1,SEG1_TOP_A_2,SEG1_TOP_A_3,THETA1_1,THETA1_2,THETA1_3,THETA2_1,THETA2_2,THETA2_3,THETA3_1,THETA3_2,THETA3_3)

%    This function was generated by the Symbolic Math Toolbox version 9.0.
%    16-Jun-2022 15:05:02

et1 = ((omega3_2.*cos(theta3_3).*sin(theta3_2)+omega3_3.*cos(theta3_2).*sin(theta3_3)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+(omega3_3.*cos(theta3_2).*cos(theta3_3)-omega3_2.*sin(theta3_2).*sin(theta3_3)).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))-omega3_2.*cos(theta3_1).*cos(theta3_2).^2).*(I3x.*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).^2+I3y.*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).^2+I3z.*cos(theta3_2).^2.*sin(theta3_1).^2);
et2 = ((cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(omega3_1.*cos(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1)-omega3_2.*cos(theta3_1).*cos(theta3_2).*cos(theta3_3)+omega3_1.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_3.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3))+(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(omega3_1.*cos(theta3_1).*cos(theta3_3)-omega3_3.*sin(theta3_1).*sin(theta3_3)+omega3_2.*cos(theta3_1).*cos(theta3_2).*sin(theta3_3)+omega3_3.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)-omega3_1.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_1).*(omega3_1.*cos(theta3_2).*sin(theta3_1)+omega3_2.*cos(theta3_1).*sin(theta3_2))).*(I3z.*cos(theta3_2).*sin(theta3_1).*sin(theta3_2)-I3x.*cos(theta3_2).*cos(theta3_3).*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2))+I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)));
et3 = -(-sin(theta3_2).*(omega3_1.*cos(theta3_1).*cos(theta3_2)-omega3_2.*sin(theta3_1).*sin(theta3_2))+cos(theta3_2).*cos(theta3_3).*(omega3_3.*cos(theta3_1).*cos(theta3_3)-omega3_1.*sin(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_2.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1)-omega3_3.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_3).*(omega3_1.*cos(theta3_3).*sin(theta3_1)+omega3_3.*cos(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_2.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2))).*(I3x.*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+I3y.*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3))-I3z.*cos(theta3_1).*cos(theta3_2).^2.*sin(theta3_1));
et4 = -sin(theta3_2).*(omega3_1.^2.*cos(theta3_2).*sin(theta3_1)+omega3_2.^2.*cos(theta3_2).*sin(theta3_1)+omega3_1.*omega3_2.*cos(theta3_1).*sin(theta3_2).*2.0)+omega3_2.*cos(theta3_2).*(omega3_1.*cos(theta3_1).*cos(theta3_2)-omega3_2.*sin(theta3_1).*sin(theta3_2))+cos(theta3_2).*cos(theta3_3).*(omega3_1.^2.*cos(theta3_1).*sin(theta3_3)+omega3_3.^2.*cos(theta3_1).*sin(theta3_3)+omega3_1.^2.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_2.^2.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_3.^2.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_1.*omega3_3.*cos(theta3_3).*sin(theta3_1).*2.0-omega3_1.*omega3_2.*cos(theta3_1).*cos(theta3_2).*cos(theta3_3).*2.0+omega3_1.*omega3_3.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3).*2.0+omega3_2.*omega3_3.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3).*2.0);
et5 = -cos(theta3_2).*sin(theta3_3).*(omega3_1.^2.*cos(theta3_1).*cos(theta3_3)+omega3_3.^2.*cos(theta3_1).*cos(theta3_3)-omega3_1.*omega3_3.*sin(theta3_1).*sin(theta3_3).*2.0-omega3_1.^2.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3)-omega3_2.^2.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3)-omega3_3.^2.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_1.*omega3_2.*cos(theta3_1).*cos(theta3_2).*sin(theta3_3).*2.0+omega3_1.*omega3_3.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2).*2.0+omega3_2.*omega3_3.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1).*2.0)-omega3_3.*cos(theta3_2).*cos(theta3_3).*(omega3_1.*cos(theta3_3).*sin(theta3_1)+omega3_3.*cos(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_2.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2))+omega3_2.*cos(theta3_3).*sin(theta3_2).*(omega3_3.*cos(theta3_1).*cos(theta3_3)-omega3_1.*sin(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_2.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1)-omega3_3.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3));
et6 = omega3_3.*cos(theta3_2).*sin(theta3_3).*(omega3_3.*cos(theta3_1).*cos(theta3_3)-omega3_1.*sin(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_2.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1)-omega3_3.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+omega3_2.*sin(theta3_2).*sin(theta3_3).*(omega3_1.*cos(theta3_3).*sin(theta3_1)+omega3_3.*cos(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_2.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2));
et7 = ((cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(omega3_1.*cos(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1)-omega3_2.*cos(theta3_1).*cos(theta3_2).*cos(theta3_3)+omega3_1.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_3.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3))+(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(omega3_1.*cos(theta3_1).*cos(theta3_3)-omega3_3.*sin(theta3_1).*sin(theta3_3)+omega3_2.*cos(theta3_1).*cos(theta3_2).*sin(theta3_3)+omega3_3.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)-omega3_1.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_1).*(omega3_1.*cos(theta3_2).*sin(theta3_1)+omega3_2.*cos(theta3_1).*sin(theta3_2))).*(I3z.*sin(theta3_2).^2+I3x.*cos(theta3_2).^2.*cos(theta3_3).^2+I3y.*cos(theta3_2).^2.*sin(theta3_3).^2);
et8 = (-sin(theta3_2).*(omega3_1.*cos(theta3_1).*cos(theta3_2)-omega3_2.*sin(theta3_1).*sin(theta3_2))+cos(theta3_2).*cos(theta3_3).*(omega3_3.*cos(theta3_1).*cos(theta3_3)-omega3_1.*sin(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_2.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1)-omega3_3.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_3).*(omega3_1.*cos(theta3_3).*sin(theta3_1)+omega3_3.*cos(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_2.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2))).*(I3z.*cos(theta3_1).*cos(theta3_2).*sin(theta3_2)+I3x.*cos(theta3_2).*cos(theta3_3).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))-I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)));
et9 = ((omega3_2.*cos(theta3_3).*sin(theta3_2)+omega3_3.*cos(theta3_2).*sin(theta3_3)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+(omega3_3.*cos(theta3_2).*cos(theta3_3)-omega3_2.*sin(theta3_2).*sin(theta3_3)).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))-omega3_2.*cos(theta3_1).*cos(theta3_2).^2).*(I3z.*cos(theta3_2).*sin(theta3_1).*sin(theta3_2)-I3x.*cos(theta3_2).*cos(theta3_3).*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2))+I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)));
et10 = (sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2)).*(omega3_2.^2.*cos(theta3_2).*cos(theta3_3)+omega3_3.^2.*cos(theta3_2).*cos(theta3_3)-omega3_2.*omega3_3.*sin(theta3_2).*sin(theta3_3).*2.0)-(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(omega3_2.^2.*cos(theta3_2).*sin(theta3_3)+omega3_3.^2.*cos(theta3_2).*sin(theta3_3)+omega3_2.*omega3_3.*cos(theta3_3).*sin(theta3_2).*2.0)+(omega3_2.*cos(theta3_3).*sin(theta3_2)+omega3_3.*cos(theta3_2).*sin(theta3_3)).*(omega3_1.*cos(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1)-omega3_2.*cos(theta3_1).*cos(theta3_2).*cos(theta3_3)+omega3_1.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_3.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3))+(omega3_3.*cos(theta3_2).*cos(theta3_3)-omega3_2.*sin(theta3_2).*sin(theta3_3)).*(omega3_1.*cos(theta3_1).*cos(theta3_3)-omega3_3.*sin(theta3_1).*sin(theta3_3)+omega3_2.*cos(theta3_1).*cos(theta3_2).*sin(theta3_3)+omega3_3.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)-omega3_1.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3));
et11 = omega3_1.*omega3_2.*cos(theta3_2).^2.*sin(theta3_1)+omega3_2.^2.*cos(theta3_1).*cos(theta3_2).*sin(theta3_2).*2.0;
et12 = -(omega3_1.*cos(theta3_1).*cos(theta3_3)-omega3_3.*sin(theta3_1).*sin(theta3_3)+omega3_2.*cos(theta3_1).*cos(theta3_2).*sin(theta3_3)+omega3_3.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)-omega3_1.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(omega3_1.*cos(theta3_3).*sin(theta3_1)+omega3_3.*cos(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_2.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2))+(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(-omega3_1.^2.*sin(theta3_1).*sin(theta3_3)-omega3_3.^2.*sin(theta3_1).*sin(theta3_3)+omega3_1.^2.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_2.^2.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_3.^2.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_1.*omega3_3.*cos(theta3_1).*cos(theta3_3).*2.0+omega3_1.*omega3_2.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1).*2.0+omega3_2.*omega3_3.*cos(theta3_1).*cos(theta3_2).*sin(theta3_3).*2.0-omega3_1.*omega3_3.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3).*2.0);
et13 = -(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(omega3_1.^2.*cos(theta3_3).*sin(theta3_1)+omega3_3.^2.*cos(theta3_3).*sin(theta3_1)+omega3_1.^2.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_2.^2.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_3.^2.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_1.*omega3_3.*cos(theta3_1).*sin(theta3_3).*2.0-omega3_2.*omega3_3.*cos(theta3_1).*cos(theta3_2).*cos(theta3_3).*2.0+omega3_1.*omega3_2.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3).*2.0+omega3_1.*omega3_3.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2).*2.0)+(omega3_1.*cos(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1)-omega3_2.*cos(theta3_1).*cos(theta3_2).*cos(theta3_3)+omega3_1.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_3.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(omega3_3.*cos(theta3_1).*cos(theta3_3)-omega3_1.*sin(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_2.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1)-omega3_3.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3));
et14 = cos(theta3_2).*sin(theta3_1).*(omega3_1.^2.*cos(theta3_1).*cos(theta3_2)+omega3_2.^2.*cos(theta3_1).*cos(theta3_2)-omega3_1.*omega3_2.*sin(theta3_1).*sin(theta3_2).*2.0)-omega3_2.*sin(theta3_1).*sin(theta3_2).*(omega3_1.*cos(theta3_2).*sin(theta3_1)+omega3_2.*cos(theta3_1).*sin(theta3_2))+omega3_1.*cos(theta3_1).*cos(theta3_2).*(omega3_1.*cos(theta3_2).*sin(theta3_1)+omega3_2.*cos(theta3_1).*sin(theta3_2));
et15 = (et1+et2+et3).*((cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(omega3_1.*cos(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1)-omega3_2.*cos(theta3_1).*cos(theta3_2).*cos(theta3_3)+omega3_1.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_3.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3))+(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(omega3_1.*cos(theta3_1).*cos(theta3_3)-omega3_3.*sin(theta3_1).*sin(theta3_3)+omega3_2.*cos(theta3_1).*cos(theta3_2).*sin(theta3_3)+omega3_3.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)-omega3_1.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_1).*(omega3_1.*cos(theta3_2).*sin(theta3_1)+omega3_2.*cos(theta3_1).*sin(theta3_2)))+(I3x.*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2)).^2+I3y.*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).^2+I3z.*cos(theta3_1).^2.*cos(theta3_2).^2).*(et4+et5+et6);
et16 = -((omega3_2.*cos(theta3_3).*sin(theta3_2)+omega3_3.*cos(theta3_2).*sin(theta3_3)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+(omega3_3.*cos(theta3_2).*cos(theta3_3)-omega3_2.*sin(theta3_2).*sin(theta3_3)).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))-omega3_2.*cos(theta3_1).*cos(theta3_2).^2).*(et7+et8+et9)+(I3x.*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+I3y.*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3))-I3z.*cos(theta3_1).*cos(theta3_2).^2.*sin(theta3_1)).*(et10+et11);
et17 = -(I3z.*cos(theta3_1).*cos(theta3_2).*sin(theta3_2)+I3x.*cos(theta3_2).*cos(theta3_3).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))-I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))).*(et12+et13+et14)-lg3.*m3.*sin(theta3_2).*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+l2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+l2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+lg3.*omega3_1.^2.*cos(theta3_2).*sin(theta3_1)+lg3.*omega3_2.^2.*cos(theta3_2).*sin(theta3_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+l2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0+lg3.*omega3_1.*omega3_2.*cos(theta3_1).*sin(theta3_2).*2.0)+lg3.*m3.*cos(theta3_2).*sin(theta3_1).*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+l2.*omega2_2.^2.*sin(theta2_2)+lg3.*omega3_2.^2.*sin(theta3_2));
et18 = -sin(theta3_2).*(omega3_1.^2.*cos(theta3_2).*sin(theta3_1)+omega3_2.^2.*cos(theta3_2).*sin(theta3_1)+omega3_1.*omega3_2.*cos(theta3_1).*sin(theta3_2).*2.0)+omega3_2.*cos(theta3_2).*(omega3_1.*cos(theta3_1).*cos(theta3_2)-omega3_2.*sin(theta3_1).*sin(theta3_2))+cos(theta3_2).*cos(theta3_3).*(omega3_1.^2.*cos(theta3_1).*sin(theta3_3)+omega3_3.^2.*cos(theta3_1).*sin(theta3_3)+omega3_1.^2.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_2.^2.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_3.^2.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_1.*omega3_3.*cos(theta3_3).*sin(theta3_1).*2.0-omega3_1.*omega3_2.*cos(theta3_1).*cos(theta3_2).*cos(theta3_3).*2.0+omega3_1.*omega3_3.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3).*2.0+omega3_2.*omega3_3.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3).*2.0);
et19 = -cos(theta3_2).*sin(theta3_3).*(omega3_1.^2.*cos(theta3_1).*cos(theta3_3)+omega3_3.^2.*cos(theta3_1).*cos(theta3_3)-omega3_1.*omega3_3.*sin(theta3_1).*sin(theta3_3).*2.0-omega3_1.^2.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3)-omega3_2.^2.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3)-omega3_3.^2.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_1.*omega3_2.*cos(theta3_1).*cos(theta3_2).*sin(theta3_3).*2.0+omega3_1.*omega3_3.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2).*2.0+omega3_2.*omega3_3.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1).*2.0)-omega3_3.*cos(theta3_2).*cos(theta3_3).*(omega3_1.*cos(theta3_3).*sin(theta3_1)+omega3_3.*cos(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_2.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2))+omega3_2.*cos(theta3_3).*sin(theta3_2).*(omega3_3.*cos(theta3_1).*cos(theta3_3)-omega3_1.*sin(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_2.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1)-omega3_3.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3));
et20 = omega3_3.*cos(theta3_2).*sin(theta3_3).*(omega3_3.*cos(theta3_1).*cos(theta3_3)-omega3_1.*sin(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_2.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1)-omega3_3.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+omega3_2.*sin(theta3_2).*sin(theta3_3).*(omega3_1.*cos(theta3_3).*sin(theta3_1)+omega3_3.*cos(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_2.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2));
et21 = ((cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(omega3_1.*cos(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1)-omega3_2.*cos(theta3_1).*cos(theta3_2).*cos(theta3_3)+omega3_1.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_3.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3))+(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(omega3_1.*cos(theta3_1).*cos(theta3_3)-omega3_3.*sin(theta3_1).*sin(theta3_3)+omega3_2.*cos(theta3_1).*cos(theta3_2).*sin(theta3_3)+omega3_3.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)-omega3_1.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_1).*(omega3_1.*cos(theta3_2).*sin(theta3_1)+omega3_2.*cos(theta3_1).*sin(theta3_2))).*(I3z.*sin(theta3_2).^2+I3x.*cos(theta3_2).^2.*cos(theta3_3).^2+I3y.*cos(theta3_2).^2.*sin(theta3_3).^2);
et22 = (-sin(theta3_2).*(omega3_1.*cos(theta3_1).*cos(theta3_2)-omega3_2.*sin(theta3_1).*sin(theta3_2))+cos(theta3_2).*cos(theta3_3).*(omega3_3.*cos(theta3_1).*cos(theta3_3)-omega3_1.*sin(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_2.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1)-omega3_3.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_3).*(omega3_1.*cos(theta3_3).*sin(theta3_1)+omega3_3.*cos(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_2.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2))).*(I3z.*cos(theta3_1).*cos(theta3_2).*sin(theta3_2)+I3x.*cos(theta3_2).*cos(theta3_3).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))-I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)));
et23 = ((omega3_2.*cos(theta3_3).*sin(theta3_2)+omega3_3.*cos(theta3_2).*sin(theta3_3)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+(omega3_3.*cos(theta3_2).*cos(theta3_3)-omega3_2.*sin(theta3_2).*sin(theta3_3)).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))-omega3_2.*cos(theta3_1).*cos(theta3_2).^2).*(I3z.*cos(theta3_2).*sin(theta3_1).*sin(theta3_2)-I3x.*cos(theta3_2).*cos(theta3_3).*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2))+I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)));
et24 = ((cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(omega3_1.*cos(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1)-omega3_2.*cos(theta3_1).*cos(theta3_2).*cos(theta3_3)+omega3_1.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_3.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3))+(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(omega3_1.*cos(theta3_1).*cos(theta3_3)-omega3_3.*sin(theta3_1).*sin(theta3_3)+omega3_2.*cos(theta3_1).*cos(theta3_2).*sin(theta3_3)+omega3_3.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)-omega3_1.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_1).*(omega3_1.*cos(theta3_2).*sin(theta3_1)+omega3_2.*cos(theta3_1).*sin(theta3_2))).*(I3z.*cos(theta3_1).*cos(theta3_2).*sin(theta3_2)+I3x.*cos(theta3_2).*cos(theta3_3).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))-I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)));
et25 = -((omega3_2.*cos(theta3_3).*sin(theta3_2)+omega3_3.*cos(theta3_2).*sin(theta3_3)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+(omega3_3.*cos(theta3_2).*cos(theta3_3)-omega3_2.*sin(theta3_2).*sin(theta3_3)).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))-omega3_2.*cos(theta3_1).*cos(theta3_2).^2).*(I3x.*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+I3y.*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3))-I3z.*cos(theta3_1).*cos(theta3_2).^2.*sin(theta3_1));
et26 = (-sin(theta3_2).*(omega3_1.*cos(theta3_1).*cos(theta3_2)-omega3_2.*sin(theta3_1).*sin(theta3_2))+cos(theta3_2).*cos(theta3_3).*(omega3_3.*cos(theta3_1).*cos(theta3_3)-omega3_1.*sin(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_2.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1)-omega3_3.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_3).*(omega3_1.*cos(theta3_3).*sin(theta3_1)+omega3_3.*cos(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_2.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2))).*(I3x.*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2)).^2+I3y.*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).^2+I3z.*cos(theta3_1).^2.*cos(theta3_2).^2);
et27 = -(omega3_1.*cos(theta3_1).*cos(theta3_3)-omega3_3.*sin(theta3_1).*sin(theta3_3)+omega3_2.*cos(theta3_1).*cos(theta3_2).*sin(theta3_3)+omega3_3.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)-omega3_1.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(omega3_1.*cos(theta3_3).*sin(theta3_1)+omega3_3.*cos(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_2.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2))+(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(-omega3_1.^2.*sin(theta3_1).*sin(theta3_3)-omega3_3.^2.*sin(theta3_1).*sin(theta3_3)+omega3_1.^2.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_2.^2.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_3.^2.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_1.*omega3_3.*cos(theta3_1).*cos(theta3_3).*2.0+omega3_1.*omega3_2.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1).*2.0+omega3_2.*omega3_3.*cos(theta3_1).*cos(theta3_2).*sin(theta3_3).*2.0-omega3_1.*omega3_3.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3).*2.0);
et28 = -(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(omega3_1.^2.*cos(theta3_3).*sin(theta3_1)+omega3_3.^2.*cos(theta3_3).*sin(theta3_1)+omega3_1.^2.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_2.^2.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_3.^2.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_1.*omega3_3.*cos(theta3_1).*sin(theta3_3).*2.0-omega3_2.*omega3_3.*cos(theta3_1).*cos(theta3_2).*cos(theta3_3).*2.0+omega3_1.*omega3_2.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3).*2.0+omega3_1.*omega3_3.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2).*2.0)+(omega3_1.*cos(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1)-omega3_2.*cos(theta3_1).*cos(theta3_2).*cos(theta3_3)+omega3_1.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_3.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(omega3_3.*cos(theta3_1).*cos(theta3_3)-omega3_1.*sin(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_2.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1)-omega3_3.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3));
et29 = cos(theta3_2).*sin(theta3_1).*(omega3_1.^2.*cos(theta3_1).*cos(theta3_2)+omega3_2.^2.*cos(theta3_1).*cos(theta3_2)-omega3_1.*omega3_2.*sin(theta3_1).*sin(theta3_2).*2.0)-omega3_2.*sin(theta3_1).*sin(theta3_2).*(omega3_1.*cos(theta3_2).*sin(theta3_1)+omega3_2.*cos(theta3_1).*sin(theta3_2))+omega3_1.*cos(theta3_1).*cos(theta3_2).*(omega3_1.*cos(theta3_2).*sin(theta3_1)+omega3_2.*cos(theta3_1).*sin(theta3_2));
et30 = (sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2)).*(omega3_2.^2.*cos(theta3_2).*cos(theta3_3)+omega3_3.^2.*cos(theta3_2).*cos(theta3_3)-omega3_2.*omega3_3.*sin(theta3_2).*sin(theta3_3).*2.0)-(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(omega3_2.^2.*cos(theta3_2).*sin(theta3_3)+omega3_3.^2.*cos(theta3_2).*sin(theta3_3)+omega3_2.*omega3_3.*cos(theta3_3).*sin(theta3_2).*2.0)+(omega3_2.*cos(theta3_3).*sin(theta3_2)+omega3_3.*cos(theta3_2).*sin(theta3_3)).*(omega3_1.*cos(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1)-omega3_2.*cos(theta3_1).*cos(theta3_2).*cos(theta3_3)+omega3_1.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_3.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3))+(omega3_3.*cos(theta3_2).*cos(theta3_3)-omega3_2.*sin(theta3_2).*sin(theta3_3)).*(omega3_1.*cos(theta3_1).*cos(theta3_3)-omega3_3.*sin(theta3_1).*sin(theta3_3)+omega3_2.*cos(theta3_1).*cos(theta3_2).*sin(theta3_3)+omega3_3.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)-omega3_1.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3));
et31 = omega3_1.*omega3_2.*cos(theta3_2).^2.*sin(theta3_1)+omega3_2.^2.*cos(theta3_1).*cos(theta3_2).*sin(theta3_2).*2.0;
et32 = (I3x.*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+I3y.*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3))-I3z.*cos(theta3_1).*cos(theta3_2).^2.*sin(theta3_1)).*(et18+et19+et20)-(-sin(theta3_2).*(omega3_1.*cos(theta3_1).*cos(theta3_2)-omega3_2.*sin(theta3_1).*sin(theta3_2))+cos(theta3_2).*cos(theta3_3).*(omega3_3.*cos(theta3_1).*cos(theta3_3)-omega3_1.*sin(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_2.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1)-omega3_3.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_3).*(omega3_1.*cos(theta3_3).*sin(theta3_1)+omega3_3.*cos(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_2.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2))).*(et21+et22+et23);
et33 = (et24+et25+et26).*((cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(omega3_1.*cos(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1)-omega3_2.*cos(theta3_1).*cos(theta3_2).*cos(theta3_3)+omega3_1.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_3.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3))+(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(omega3_1.*cos(theta3_1).*cos(theta3_3)-omega3_3.*sin(theta3_1).*sin(theta3_3)+omega3_2.*cos(theta3_1).*cos(theta3_2).*sin(theta3_3)+omega3_3.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)-omega3_1.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_1).*(omega3_1.*cos(theta3_2).*sin(theta3_1)+omega3_2.*cos(theta3_1).*sin(theta3_2)))+(I3z.*cos(theta3_2).*sin(theta3_1).*sin(theta3_2)-I3x.*cos(theta3_2).*cos(theta3_3).*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2))+I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3))).*(et27+et28+et29);
et34 = (I3x.*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).^2+I3y.*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).^2+I3z.*cos(theta3_2).^2.*sin(theta3_1).^2).*(et30+et31)-lg3.*m3.*sin(theta3_2).*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+l2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+l2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)+lg3.*omega3_1.^2.*cos(theta3_1).*cos(theta3_2)+lg3.*omega3_2.^2.*cos(theta3_1).*cos(theta3_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-l2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0-lg3.*omega3_1.*omega3_2.*sin(theta3_1).*sin(theta3_2).*2.0)+lg3.*m3.*cos(theta3_1).*cos(theta3_2).*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+l2.*omega2_2.^2.*sin(theta2_2)+lg3.*omega3_2.^2.*sin(theta3_2));
et35 = -sin(theta3_2).*(omega3_1.^2.*cos(theta3_2).*sin(theta3_1)+omega3_2.^2.*cos(theta3_2).*sin(theta3_1)+omega3_1.*omega3_2.*cos(theta3_1).*sin(theta3_2).*2.0)+omega3_2.*cos(theta3_2).*(omega3_1.*cos(theta3_1).*cos(theta3_2)-omega3_2.*sin(theta3_1).*sin(theta3_2))+cos(theta3_2).*cos(theta3_3).*(omega3_1.^2.*cos(theta3_1).*sin(theta3_3)+omega3_3.^2.*cos(theta3_1).*sin(theta3_3)+omega3_1.^2.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_2.^2.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_3.^2.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_1.*omega3_3.*cos(theta3_3).*sin(theta3_1).*2.0-omega3_1.*omega3_2.*cos(theta3_1).*cos(theta3_2).*cos(theta3_3).*2.0+omega3_1.*omega3_3.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3).*2.0+omega3_2.*omega3_3.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3).*2.0);
et36 = -cos(theta3_2).*sin(theta3_3).*(omega3_1.^2.*cos(theta3_1).*cos(theta3_3)+omega3_3.^2.*cos(theta3_1).*cos(theta3_3)-omega3_1.*omega3_3.*sin(theta3_1).*sin(theta3_3).*2.0-omega3_1.^2.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3)-omega3_2.^2.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3)-omega3_3.^2.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_1.*omega3_2.*cos(theta3_1).*cos(theta3_2).*sin(theta3_3).*2.0+omega3_1.*omega3_3.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2).*2.0+omega3_2.*omega3_3.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1).*2.0)-omega3_3.*cos(theta3_2).*cos(theta3_3).*(omega3_1.*cos(theta3_3).*sin(theta3_1)+omega3_3.*cos(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_2.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2))+omega3_2.*cos(theta3_3).*sin(theta3_2).*(omega3_3.*cos(theta3_1).*cos(theta3_3)-omega3_1.*sin(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_2.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1)-omega3_3.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3));
et37 = omega3_3.*cos(theta3_2).*sin(theta3_3).*(omega3_3.*cos(theta3_1).*cos(theta3_3)-omega3_1.*sin(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_2.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1)-omega3_3.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+omega3_2.*sin(theta3_2).*sin(theta3_3).*(omega3_1.*cos(theta3_3).*sin(theta3_1)+omega3_3.*cos(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_2.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2));
et38 = ((cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(omega3_1.*cos(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1)-omega3_2.*cos(theta3_1).*cos(theta3_2).*cos(theta3_3)+omega3_1.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_3.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3))+(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(omega3_1.*cos(theta3_1).*cos(theta3_3)-omega3_3.*sin(theta3_1).*sin(theta3_3)+omega3_2.*cos(theta3_1).*cos(theta3_2).*sin(theta3_3)+omega3_3.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)-omega3_1.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_1).*(omega3_1.*cos(theta3_2).*sin(theta3_1)+omega3_2.*cos(theta3_1).*sin(theta3_2))).*(I3z.*cos(theta3_1).*cos(theta3_2).*sin(theta3_2)+I3x.*cos(theta3_2).*cos(theta3_3).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))-I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)));
et39 = -((omega3_2.*cos(theta3_3).*sin(theta3_2)+omega3_3.*cos(theta3_2).*sin(theta3_3)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+(omega3_3.*cos(theta3_2).*cos(theta3_3)-omega3_2.*sin(theta3_2).*sin(theta3_3)).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))-omega3_2.*cos(theta3_1).*cos(theta3_2).^2).*(I3x.*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+I3y.*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3))-I3z.*cos(theta3_1).*cos(theta3_2).^2.*sin(theta3_1));
et40 = (-sin(theta3_2).*(omega3_1.*cos(theta3_1).*cos(theta3_2)-omega3_2.*sin(theta3_1).*sin(theta3_2))+cos(theta3_2).*cos(theta3_3).*(omega3_3.*cos(theta3_1).*cos(theta3_3)-omega3_1.*sin(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_2.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1)-omega3_3.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_3).*(omega3_1.*cos(theta3_3).*sin(theta3_1)+omega3_3.*cos(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_2.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2))).*(I3x.*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2)).^2+I3y.*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).^2+I3z.*cos(theta3_1).^2.*cos(theta3_2).^2);
et41 = ((omega3_2.*cos(theta3_3).*sin(theta3_2)+omega3_3.*cos(theta3_2).*sin(theta3_3)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+(omega3_3.*cos(theta3_2).*cos(theta3_3)-omega3_2.*sin(theta3_2).*sin(theta3_3)).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))-omega3_2.*cos(theta3_1).*cos(theta3_2).^2).*(I3x.*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).^2+I3y.*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).^2+I3z.*cos(theta3_2).^2.*sin(theta3_1).^2);
et42 = ((cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(omega3_1.*cos(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1)-omega3_2.*cos(theta3_1).*cos(theta3_2).*cos(theta3_3)+omega3_1.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_3.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3))+(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(omega3_1.*cos(theta3_1).*cos(theta3_3)-omega3_3.*sin(theta3_1).*sin(theta3_3)+omega3_2.*cos(theta3_1).*cos(theta3_2).*sin(theta3_3)+omega3_3.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)-omega3_1.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_1).*(omega3_1.*cos(theta3_2).*sin(theta3_1)+omega3_2.*cos(theta3_1).*sin(theta3_2))).*(I3z.*cos(theta3_2).*sin(theta3_1).*sin(theta3_2)-I3x.*cos(theta3_2).*cos(theta3_3).*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2))+I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)));
et43 = -(-sin(theta3_2).*(omega3_1.*cos(theta3_1).*cos(theta3_2)-omega3_2.*sin(theta3_1).*sin(theta3_2))+cos(theta3_2).*cos(theta3_3).*(omega3_3.*cos(theta3_1).*cos(theta3_3)-omega3_1.*sin(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_2.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1)-omega3_3.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_3).*(omega3_1.*cos(theta3_3).*sin(theta3_1)+omega3_3.*cos(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_2.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2))).*(I3x.*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+I3y.*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3))-I3z.*cos(theta3_1).*cos(theta3_2).^2.*sin(theta3_1));
et44 = (sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2)).*(omega3_2.^2.*cos(theta3_2).*cos(theta3_3)+omega3_3.^2.*cos(theta3_2).*cos(theta3_3)-omega3_2.*omega3_3.*sin(theta3_2).*sin(theta3_3).*2.0)-(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(omega3_2.^2.*cos(theta3_2).*sin(theta3_3)+omega3_3.^2.*cos(theta3_2).*sin(theta3_3)+omega3_2.*omega3_3.*cos(theta3_3).*sin(theta3_2).*2.0)+(omega3_2.*cos(theta3_3).*sin(theta3_2)+omega3_3.*cos(theta3_2).*sin(theta3_3)).*(omega3_1.*cos(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1)-omega3_2.*cos(theta3_1).*cos(theta3_2).*cos(theta3_3)+omega3_1.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_3.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3))+(omega3_3.*cos(theta3_2).*cos(theta3_3)-omega3_2.*sin(theta3_2).*sin(theta3_3)).*(omega3_1.*cos(theta3_1).*cos(theta3_3)-omega3_3.*sin(theta3_1).*sin(theta3_3)+omega3_2.*cos(theta3_1).*cos(theta3_2).*sin(theta3_3)+omega3_3.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)-omega3_1.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3));
et45 = omega3_1.*omega3_2.*cos(theta3_2).^2.*sin(theta3_1)+omega3_2.^2.*cos(theta3_1).*cos(theta3_2).*sin(theta3_2).*2.0;
et46 = -(omega3_1.*cos(theta3_1).*cos(theta3_3)-omega3_3.*sin(theta3_1).*sin(theta3_3)+omega3_2.*cos(theta3_1).*cos(theta3_2).*sin(theta3_3)+omega3_3.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)-omega3_1.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(omega3_1.*cos(theta3_3).*sin(theta3_1)+omega3_3.*cos(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_2.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2))+(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(-omega3_1.^2.*sin(theta3_1).*sin(theta3_3)-omega3_3.^2.*sin(theta3_1).*sin(theta3_3)+omega3_1.^2.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_2.^2.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_3.^2.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_1.*omega3_3.*cos(theta3_1).*cos(theta3_3).*2.0+omega3_1.*omega3_2.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1).*2.0+omega3_2.*omega3_3.*cos(theta3_1).*cos(theta3_2).*sin(theta3_3).*2.0-omega3_1.*omega3_3.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3).*2.0);
et47 = -(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(omega3_1.^2.*cos(theta3_3).*sin(theta3_1)+omega3_3.^2.*cos(theta3_3).*sin(theta3_1)+omega3_1.^2.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_2.^2.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_3.^2.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_1.*omega3_3.*cos(theta3_1).*sin(theta3_3).*2.0-omega3_2.*omega3_3.*cos(theta3_1).*cos(theta3_2).*cos(theta3_3).*2.0+omega3_1.*omega3_2.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3).*2.0+omega3_1.*omega3_3.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2).*2.0)+(omega3_1.*cos(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1)-omega3_2.*cos(theta3_1).*cos(theta3_2).*cos(theta3_3)+omega3_1.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2)+omega3_3.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(omega3_3.*cos(theta3_1).*cos(theta3_3)-omega3_1.*sin(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_2.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1)-omega3_3.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3));
et48 = cos(theta3_2).*sin(theta3_1).*(omega3_1.^2.*cos(theta3_1).*cos(theta3_2)+omega3_2.^2.*cos(theta3_1).*cos(theta3_2)-omega3_1.*omega3_2.*sin(theta3_1).*sin(theta3_2).*2.0)-omega3_2.*sin(theta3_1).*sin(theta3_2).*(omega3_1.*cos(theta3_2).*sin(theta3_1)+omega3_2.*cos(theta3_1).*sin(theta3_2))+omega3_1.*cos(theta3_1).*cos(theta3_2).*(omega3_1.*cos(theta3_2).*sin(theta3_1)+omega3_2.*cos(theta3_1).*sin(theta3_2));
et49 = (I3z.*cos(theta3_1).*cos(theta3_2).*sin(theta3_2)+I3x.*cos(theta3_2).*cos(theta3_3).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))-I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))).*(et35+et36+et37)+((omega3_2.*cos(theta3_3).*sin(theta3_2)+omega3_3.*cos(theta3_2).*sin(theta3_3)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+(omega3_3.*cos(theta3_2).*cos(theta3_3)-omega3_2.*sin(theta3_2).*sin(theta3_3)).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))-omega3_2.*cos(theta3_1).*cos(theta3_2).^2).*(et38+et39+et40);
et50 = -(-sin(theta3_2).*(omega3_1.*cos(theta3_1).*cos(theta3_2)-omega3_2.*sin(theta3_1).*sin(theta3_2))+cos(theta3_2).*cos(theta3_3).*(omega3_3.*cos(theta3_1).*cos(theta3_3)-omega3_1.*sin(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*cos(theta3_3).*sin(theta3_2)+omega3_2.*cos(theta3_2).*cos(theta3_3).*sin(theta3_1)-omega3_3.*sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_3).*(omega3_1.*cos(theta3_3).*sin(theta3_1)+omega3_3.*cos(theta3_1).*sin(theta3_3)+omega3_1.*cos(theta3_1).*sin(theta3_2).*sin(theta3_3)+omega3_2.*cos(theta3_2).*sin(theta3_1).*sin(theta3_3)+omega3_3.*cos(theta3_3).*sin(theta3_1).*sin(theta3_2))).*(et41+et42+et43)-(I3z.*cos(theta3_2).*sin(theta3_1).*sin(theta3_2)-I3x.*cos(theta3_2).*cos(theta3_3).*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2))+I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3))).*(et44+et45);
et51 = -(I3z.*sin(theta3_2).^2+I3x.*cos(theta3_2).^2.*cos(theta3_3).^2+I3y.*cos(theta3_2).^2.*sin(theta3_3).^2).*(et46+et47+et48)-lg3.*m3.*cos(theta3_2).*sin(theta3_1).*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+l2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+l2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)+lg3.*omega3_1.^2.*cos(theta3_1).*cos(theta3_2)+lg3.*omega3_2.^2.*cos(theta3_1).*cos(theta3_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-l2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0-lg3.*omega3_1.*omega3_2.*sin(theta3_1).*sin(theta3_2).*2.0);
et52 = lg3.*m3.*cos(theta3_1).*cos(theta3_2).*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+l2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+l2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+lg3.*omega3_1.^2.*cos(theta3_2).*sin(theta3_1)+lg3.*omega3_2.^2.*cos(theta3_2).*sin(theta3_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+l2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0+lg3.*omega3_1.*omega3_2.*cos(theta3_1).*sin(theta3_2).*2.0);
et53 = ((omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))-omega2_2.*cos(theta2_1).*cos(theta2_2).^2).*(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).^2+I2y.*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).^2+I2z.*cos(theta2_2).^2.*sin(theta2_1).^2);
et54 = ((cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_1).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2))).*(I2z.*cos(theta2_2).*sin(theta2_1).*sin(theta2_2)-I2x.*cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et55 = -(-sin(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))).*(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))-I2z.*cos(theta2_1).*cos(theta2_2).^2.*sin(theta2_1));
et56 = -sin(theta2_2).*(omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0)+omega2_2.*cos(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_1.^2.*cos(theta2_1).*sin(theta2_3)+omega2_3.^2.*cos(theta2_1).*sin(theta2_3)+omega2_1.^2.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_2.^2.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.^2.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_1.*omega2_3.*cos(theta2_3).*sin(theta2_1).*2.0-omega2_1.*omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3).*2.0+omega2_1.*omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3).*2.0+omega2_2.*omega2_3.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3).*2.0);
et57 = -cos(theta2_2).*sin(theta2_3).*(omega2_1.^2.*cos(theta2_1).*cos(theta2_3)+omega2_3.^2.*cos(theta2_1).*cos(theta2_3)-omega2_1.*omega2_3.*sin(theta2_1).*sin(theta2_3).*2.0-omega2_1.^2.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)-omega2_2.^2.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)-omega2_3.^2.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_1.*omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3).*2.0+omega2_1.*omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2).*2.0+omega2_2.*omega2_3.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1).*2.0)-omega2_3.*cos(theta2_2).*cos(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+omega2_2.*cos(theta2_3).*sin(theta2_2).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3));
et58 = omega2_3.*cos(theta2_2).*sin(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+omega2_2.*sin(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2));
et59 = ((cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_1).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2))).*(I2z.*sin(theta2_2).^2+I2x.*cos(theta2_2).^2.*cos(theta2_3).^2+I2y.*cos(theta2_2).^2.*sin(theta2_3).^2);
et60 = (-sin(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))).*(I2z.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2)+I2x.*cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et61 = ((omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))-omega2_2.*cos(theta2_1).*cos(theta2_2).^2).*(I2z.*cos(theta2_2).*sin(theta2_1).*sin(theta2_2)-I2x.*cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et62 = (sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2)).*(omega2_2.^2.*cos(theta2_2).*cos(theta2_3)+omega2_3.^2.*cos(theta2_2).*cos(theta2_3)-omega2_2.*omega2_3.*sin(theta2_2).*sin(theta2_3).*2.0)-(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_2.^2.*cos(theta2_2).*sin(theta2_3)+omega2_3.^2.*cos(theta2_2).*sin(theta2_3)+omega2_2.*omega2_3.*cos(theta2_3).*sin(theta2_2).*2.0)+(omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3));
et63 = omega2_1.*omega2_2.*cos(theta2_2).^2.*sin(theta2_1)+omega2_2.^2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2).*2.0;
et64 = -(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(-omega2_1.^2.*sin(theta2_1).*sin(theta2_3)-omega2_3.^2.*sin(theta2_1).*sin(theta2_3)+omega2_1.^2.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.^2.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_3.^2.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_1.*omega2_3.*cos(theta2_1).*cos(theta2_3).*2.0+omega2_1.*omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1).*2.0+omega2_2.*omega2_3.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3).*2.0-omega2_1.*omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3).*2.0);
et65 = -(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.^2.*cos(theta2_3).*sin(theta2_1)+omega2_3.^2.*cos(theta2_3).*sin(theta2_1)+omega2_1.^2.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.^2.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_3.^2.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_1.*omega2_3.*cos(theta2_1).*sin(theta2_3).*2.0-omega2_2.*omega2_3.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3).*2.0+omega2_1.*omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3).*2.0+omega2_1.*omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2).*2.0)+(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3));
et66 = cos(theta2_2).*sin(theta2_1).*(omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+omega2_2.^2.*cos(theta2_1).*cos(theta2_2)-omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0)-omega2_2.*sin(theta2_1).*sin(theta2_2).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2))+omega2_1.*cos(theta2_1).*cos(theta2_2).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2));
et67 = (et53+et54+et55).*((cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_1).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2)))+(I2x.*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2)).^2+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).^2+I2z.*cos(theta2_1).^2.*cos(theta2_2).^2).*(et56+et57+et58);
et68 = -((omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))-omega2_2.*cos(theta2_1).*cos(theta2_2).^2).*(et59+et60+et61)+(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))-I2z.*cos(theta2_1).*cos(theta2_2).^2.*sin(theta2_1)).*(et62+et63);
et69 = -(I2z.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2)+I2x.*cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))).*(et64+et65+et66);
et70 = -lg2.*sin(theta2_2).*(m2.*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+lg2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+lg2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+lg2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0)+m3.*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+l2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+l2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+lg3.*omega3_1.^2.*cos(theta3_2).*sin(theta3_1)+lg3.*omega3_2.^2.*cos(theta3_2).*sin(theta3_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+l2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0+lg3.*omega3_1.*omega3_2.*cos(theta3_1).*sin(theta3_2).*2.0));
et71 = -m3.*(l2.*sin(theta2_2)-lg2.*sin(theta2_2)).*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+l2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+l2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+lg3.*omega3_1.^2.*cos(theta3_2).*sin(theta3_1)+lg3.*omega3_2.^2.*cos(theta3_2).*sin(theta3_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+l2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0+lg3.*omega3_1.*omega3_2.*cos(theta3_1).*sin(theta3_2).*2.0)+m3.*(l2.*cos(theta2_2).*sin(theta2_1)-lg2.*cos(theta2_2).*sin(theta2_1)).*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+l2.*omega2_2.^2.*sin(theta2_2)+lg3.*omega3_2.^2.*sin(theta3_2))+lg2.*cos(theta2_2).*sin(theta2_1).*(m2.*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+lg2.*omega2_2.^2.*sin(theta2_2))+m3.*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+l2.*omega2_2.^2.*sin(theta2_2)+lg3.*omega3_2.^2.*sin(theta3_2)));
et72 = -sin(theta2_2).*(omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0)+omega2_2.*cos(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_1.^2.*cos(theta2_1).*sin(theta2_3)+omega2_3.^2.*cos(theta2_1).*sin(theta2_3)+omega2_1.^2.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_2.^2.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.^2.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_1.*omega2_3.*cos(theta2_3).*sin(theta2_1).*2.0-omega2_1.*omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3).*2.0+omega2_1.*omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3).*2.0+omega2_2.*omega2_3.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3).*2.0);
et73 = -cos(theta2_2).*sin(theta2_3).*(omega2_1.^2.*cos(theta2_1).*cos(theta2_3)+omega2_3.^2.*cos(theta2_1).*cos(theta2_3)-omega2_1.*omega2_3.*sin(theta2_1).*sin(theta2_3).*2.0-omega2_1.^2.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)-omega2_2.^2.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)-omega2_3.^2.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_1.*omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3).*2.0+omega2_1.*omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2).*2.0+omega2_2.*omega2_3.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1).*2.0)-omega2_3.*cos(theta2_2).*cos(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+omega2_2.*cos(theta2_3).*sin(theta2_2).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3));
et74 = omega2_3.*cos(theta2_2).*sin(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+omega2_2.*sin(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2));
et75 = ((cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_1).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2))).*(I2z.*sin(theta2_2).^2+I2x.*cos(theta2_2).^2.*cos(theta2_3).^2+I2y.*cos(theta2_2).^2.*sin(theta2_3).^2);
et76 = (-sin(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))).*(I2z.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2)+I2x.*cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et77 = ((omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))-omega2_2.*cos(theta2_1).*cos(theta2_2).^2).*(I2z.*cos(theta2_2).*sin(theta2_1).*sin(theta2_2)-I2x.*cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et78 = ((cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_1).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2))).*(I2z.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2)+I2x.*cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et79 = -((omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))-omega2_2.*cos(theta2_1).*cos(theta2_2).^2).*(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))-I2z.*cos(theta2_1).*cos(theta2_2).^2.*sin(theta2_1));
et80 = (-sin(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))).*(I2x.*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2)).^2+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).^2+I2z.*cos(theta2_1).^2.*cos(theta2_2).^2);
et81 = -(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(-omega2_1.^2.*sin(theta2_1).*sin(theta2_3)-omega2_3.^2.*sin(theta2_1).*sin(theta2_3)+omega2_1.^2.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.^2.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_3.^2.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_1.*omega2_3.*cos(theta2_1).*cos(theta2_3).*2.0+omega2_1.*omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1).*2.0+omega2_2.*omega2_3.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3).*2.0-omega2_1.*omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3).*2.0);
et82 = -(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.^2.*cos(theta2_3).*sin(theta2_1)+omega2_3.^2.*cos(theta2_3).*sin(theta2_1)+omega2_1.^2.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.^2.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_3.^2.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_1.*omega2_3.*cos(theta2_1).*sin(theta2_3).*2.0-omega2_2.*omega2_3.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3).*2.0+omega2_1.*omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3).*2.0+omega2_1.*omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2).*2.0)+(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3));
et83 = cos(theta2_2).*sin(theta2_1).*(omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+omega2_2.^2.*cos(theta2_1).*cos(theta2_2)-omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0)-omega2_2.*sin(theta2_1).*sin(theta2_2).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2))+omega2_1.*cos(theta2_1).*cos(theta2_2).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2));
et84 = (sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2)).*(omega2_2.^2.*cos(theta2_2).*cos(theta2_3)+omega2_3.^2.*cos(theta2_2).*cos(theta2_3)-omega2_2.*omega2_3.*sin(theta2_2).*sin(theta2_3).*2.0)-(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_2.^2.*cos(theta2_2).*sin(theta2_3)+omega2_3.^2.*cos(theta2_2).*sin(theta2_3)+omega2_2.*omega2_3.*cos(theta2_3).*sin(theta2_2).*2.0)+(omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3));
et85 = omega2_1.*omega2_2.*cos(theta2_2).^2.*sin(theta2_1)+omega2_2.^2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2).*2.0;
et86 = (I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))-I2z.*cos(theta2_1).*cos(theta2_2).^2.*sin(theta2_1)).*(et72+et73+et74)-(-sin(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))).*(et75+et76+et77);
et87 = (et78+et79+et80).*((cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_1).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2)))+(I2z.*cos(theta2_2).*sin(theta2_1).*sin(theta2_2)-I2x.*cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))).*(et81+et82+et83);
et88 = (I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).^2+I2y.*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).^2+I2z.*cos(theta2_2).^2.*sin(theta2_1).^2).*(et84+et85);
et89 = -lg2.*sin(theta2_2).*(m2.*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+lg2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+lg2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-lg2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0)+m3.*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+l2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+l2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)+lg3.*omega3_1.^2.*cos(theta3_1).*cos(theta3_2)+lg3.*omega3_2.^2.*cos(theta3_1).*cos(theta3_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-l2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0-lg3.*omega3_1.*omega3_2.*sin(theta3_1).*sin(theta3_2).*2.0))+m3.*(l2.*cos(theta2_1).*cos(theta2_2)-lg2.*cos(theta2_1).*cos(theta2_2)).*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+l2.*omega2_2.^2.*sin(theta2_2)+lg3.*omega3_2.^2.*sin(theta3_2));
et90 = -m3.*(l2.*sin(theta2_2)-lg2.*sin(theta2_2)).*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+l2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+l2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)+lg3.*omega3_1.^2.*cos(theta3_1).*cos(theta3_2)+lg3.*omega3_2.^2.*cos(theta3_1).*cos(theta3_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-l2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0-lg3.*omega3_1.*omega3_2.*sin(theta3_1).*sin(theta3_2).*2.0)+lg2.*cos(theta2_1).*cos(theta2_2).*(m2.*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+lg2.*omega2_2.^2.*sin(theta2_2))+m3.*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+l2.*omega2_2.^2.*sin(theta2_2)+lg3.*omega3_2.^2.*sin(theta3_2)));
et91 = -sin(theta2_2).*(omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0)+omega2_2.*cos(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_1.^2.*cos(theta2_1).*sin(theta2_3)+omega2_3.^2.*cos(theta2_1).*sin(theta2_3)+omega2_1.^2.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_2.^2.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.^2.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_1.*omega2_3.*cos(theta2_3).*sin(theta2_1).*2.0-omega2_1.*omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3).*2.0+omega2_1.*omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3).*2.0+omega2_2.*omega2_3.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3).*2.0);
et92 = -cos(theta2_2).*sin(theta2_3).*(omega2_1.^2.*cos(theta2_1).*cos(theta2_3)+omega2_3.^2.*cos(theta2_1).*cos(theta2_3)-omega2_1.*omega2_3.*sin(theta2_1).*sin(theta2_3).*2.0-omega2_1.^2.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)-omega2_2.^2.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)-omega2_3.^2.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_1.*omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3).*2.0+omega2_1.*omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2).*2.0+omega2_2.*omega2_3.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1).*2.0)-omega2_3.*cos(theta2_2).*cos(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+omega2_2.*cos(theta2_3).*sin(theta2_2).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3));
et93 = omega2_3.*cos(theta2_2).*sin(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+omega2_2.*sin(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2));
et94 = ((cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_1).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2))).*(I2z.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2)+I2x.*cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et95 = -((omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))-omega2_2.*cos(theta2_1).*cos(theta2_2).^2).*(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))-I2z.*cos(theta2_1).*cos(theta2_2).^2.*sin(theta2_1));
et96 = (-sin(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))).*(I2x.*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2)).^2+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).^2+I2z.*cos(theta2_1).^2.*cos(theta2_2).^2);
et97 = ((omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))-omega2_2.*cos(theta2_1).*cos(theta2_2).^2).*(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).^2+I2y.*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).^2+I2z.*cos(theta2_2).^2.*sin(theta2_1).^2);
et98 = ((cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_1).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2))).*(I2z.*cos(theta2_2).*sin(theta2_1).*sin(theta2_2)-I2x.*cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et99 = -(-sin(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))).*(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))-I2z.*cos(theta2_1).*cos(theta2_2).^2.*sin(theta2_1));
et100 = (sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2)).*(omega2_2.^2.*cos(theta2_2).*cos(theta2_3)+omega2_3.^2.*cos(theta2_2).*cos(theta2_3)-omega2_2.*omega2_3.*sin(theta2_2).*sin(theta2_3).*2.0)-(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_2.^2.*cos(theta2_2).*sin(theta2_3)+omega2_3.^2.*cos(theta2_2).*sin(theta2_3)+omega2_2.*omega2_3.*cos(theta2_3).*sin(theta2_2).*2.0)+(omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3));
et101 = omega2_1.*omega2_2.*cos(theta2_2).^2.*sin(theta2_1)+omega2_2.^2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2).*2.0;
et102 = -(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(-omega2_1.^2.*sin(theta2_1).*sin(theta2_3)-omega2_3.^2.*sin(theta2_1).*sin(theta2_3)+omega2_1.^2.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.^2.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_3.^2.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_1.*omega2_3.*cos(theta2_1).*cos(theta2_3).*2.0+omega2_1.*omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1).*2.0+omega2_2.*omega2_3.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3).*2.0-omega2_1.*omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3).*2.0);
et103 = -(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.^2.*cos(theta2_3).*sin(theta2_1)+omega2_3.^2.*cos(theta2_3).*sin(theta2_1)+omega2_1.^2.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.^2.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_3.^2.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_1.*omega2_3.*cos(theta2_1).*sin(theta2_3).*2.0-omega2_2.*omega2_3.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3).*2.0+omega2_1.*omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3).*2.0+omega2_1.*omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2).*2.0)+(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3));
et104 = cos(theta2_2).*sin(theta2_1).*(omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+omega2_2.^2.*cos(theta2_1).*cos(theta2_2)-omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0)-omega2_2.*sin(theta2_1).*sin(theta2_2).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2))+omega2_1.*cos(theta2_1).*cos(theta2_2).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2));
et105 = (I2z.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2)+I2x.*cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))).*(et91+et92+et93)+((omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))-omega2_2.*cos(theta2_1).*cos(theta2_2).^2).*(et94+et95+et96);
et106 = -(-sin(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))).*(et97+et98+et99)-(I2z.*cos(theta2_2).*sin(theta2_1).*sin(theta2_2)-I2x.*cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))).*(et100+et101);
et107 = -(I2z.*sin(theta2_2).^2+I2x.*cos(theta2_2).^2.*cos(theta2_3).^2+I2y.*cos(theta2_2).^2.*sin(theta2_3).^2).*(et102+et103+et104)+m3.*(l2.*cos(theta2_1).*cos(theta2_2)-lg2.*cos(theta2_1).*cos(theta2_2)).*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+l2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+l2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+lg3.*omega3_1.^2.*cos(theta3_2).*sin(theta3_1)+lg3.*omega3_2.^2.*cos(theta3_2).*sin(theta3_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+l2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0+lg3.*omega3_1.*omega3_2.*cos(theta3_1).*sin(theta3_2).*2.0);
et108 = -m3.*(l2.*cos(theta2_2).*sin(theta2_1)-lg2.*cos(theta2_2).*sin(theta2_1)).*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+l2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+l2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)+lg3.*omega3_1.^2.*cos(theta3_1).*cos(theta3_2)+lg3.*omega3_2.^2.*cos(theta3_1).*cos(theta3_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-l2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0-lg3.*omega3_1.*omega3_2.*sin(theta3_1).*sin(theta3_2).*2.0);
et109 = lg2.*cos(theta2_1).*cos(theta2_2).*(m2.*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+lg2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+lg2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+lg2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0)+m3.*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+l2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+l2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+lg3.*omega3_1.^2.*cos(theta3_2).*sin(theta3_1)+lg3.*omega3_2.^2.*cos(theta3_2).*sin(theta3_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+l2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0+lg3.*omega3_1.*omega3_2.*cos(theta3_1).*sin(theta3_2).*2.0));
et110 = -lg2.*cos(theta2_2).*sin(theta2_1).*(m2.*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+lg2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+lg2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-lg2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0)+m3.*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+l2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+l2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)+lg3.*omega3_1.^2.*cos(theta3_1).*cos(theta3_2)+lg3.*omega3_2.^2.*cos(theta3_1).*cos(theta3_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-l2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0-lg3.*omega3_1.*omega3_2.*sin(theta3_1).*sin(theta3_2).*2.0));
et111 = ((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).^2+I1y.*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_2).^2.*sin(theta1_1).^2);
et112 = ((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))).*(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et113 = -(-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1));
et114 = -sin(theta1_2).*(omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0)+omega1_2.*cos(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_1.^2.*cos(theta1_1).*sin(theta1_3)+omega1_3.^2.*cos(theta1_1).*sin(theta1_3)+omega1_1.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_2.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_1.*omega1_3.*cos(theta1_3).*sin(theta1_1).*2.0-omega1_1.*omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3).*2.0+omega1_2.*omega1_3.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3).*2.0);
et115 = -cos(theta1_2).*sin(theta1_3).*(omega1_1.^2.*cos(theta1_1).*cos(theta1_3)+omega1_3.^2.*cos(theta1_1).*cos(theta1_3)-omega1_1.*omega1_3.*sin(theta1_1).*sin(theta1_3).*2.0-omega1_1.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)-omega1_2.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)-omega1_3.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_1.*omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2).*2.0+omega1_2.*omega1_3.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1).*2.0)-omega1_3.*cos(theta1_2).*cos(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+omega1_2.*cos(theta1_3).*sin(theta1_2).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et116 = omega1_3.*cos(theta1_2).*sin(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+omega1_2.*sin(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2));
et117 = ((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))).*(I1z.*sin(theta1_2).^2+I1x.*cos(theta1_2).^2.*cos(theta1_3).^2+I1y.*cos(theta1_2).^2.*sin(theta1_3).^2);
et118 = (-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et119 = ((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et120 = (sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).*(omega1_2.^2.*cos(theta1_2).*cos(theta1_3)+omega1_3.^2.*cos(theta1_2).*cos(theta1_3)-omega1_2.*omega1_3.*sin(theta1_2).*sin(theta1_3).*2.0)-(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_2.^2.*cos(theta1_2).*sin(theta1_3)+omega1_3.^2.*cos(theta1_2).*sin(theta1_3)+omega1_2.*omega1_3.*cos(theta1_3).*sin(theta1_2).*2.0)+(omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et121 = omega1_1.*omega1_2.*cos(theta1_2).^2.*sin(theta1_1)+omega1_2.^2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2).*2.0;
et122 = -(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(-omega1_1.^2.*sin(theta1_1).*sin(theta1_3)-omega1_3.^2.*sin(theta1_1).*sin(theta1_3)+omega1_1.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_3.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_1.*omega1_3.*cos(theta1_1).*cos(theta1_3).*2.0+omega1_1.*omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1).*2.0+omega1_2.*omega1_3.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*2.0-omega1_1.*omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3).*2.0);
et123 = -(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.^2.*cos(theta1_3).*sin(theta1_1)+omega1_3.^2.*cos(theta1_3).*sin(theta1_1)+omega1_1.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_3.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_1.*omega1_3.*cos(theta1_1).*sin(theta1_3).*2.0-omega1_2.*omega1_3.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*2.0+omega1_1.*omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2).*2.0)+(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et124 = cos(theta1_2).*sin(theta1_1).*(omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+omega1_2.^2.*cos(theta1_1).*cos(theta1_2)-omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0)-omega1_2.*sin(theta1_1).*sin(theta1_2).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))+omega1_1.*cos(theta1_1).*cos(theta1_2).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2));
et125 = (et111+et112+et113).*((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2)))+(I1x.*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).^2+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_1).^2.*cos(theta1_2).^2).*(et114+et115+et116);
et126 = -((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(et117+et118+et119)+(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1)).*(et120+et121);
et127 = (l1.*cos(theta1_2).*sin(theta1_1)-lg1.*cos(theta1_2).*sin(theta1_1)).*(m2.*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+lg2.*omega2_2.^2.*sin(theta2_2))+m3.*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+l2.*omega2_2.^2.*sin(theta2_2)+lg3.*omega3_2.^2.*sin(theta3_2)))-(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))).*(et122+et123+et124);
et128 = -(m2.*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+lg2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+lg2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+lg2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0)+m3.*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+l2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+l2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+lg3.*omega3_1.^2.*cos(theta3_2).*sin(theta3_1)+lg3.*omega3_2.^2.*cos(theta3_2).*sin(theta3_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+l2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0+lg3.*omega3_1.*omega3_2.*cos(theta3_1).*sin(theta3_2).*2.0)).*(l1.*sin(theta1_2)-lg1.*sin(theta1_2));
et129 = -lg1.*sin(theta1_2).*(m1.*(-conj(seg1_top_a_2)+lg1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+lg1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+lg1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0)+m2.*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+lg2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+lg2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+lg2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0)+m3.*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+l2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+l2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+lg3.*omega3_1.^2.*cos(theta3_2).*sin(theta3_1)+lg3.*omega3_2.^2.*cos(theta3_2).*sin(theta3_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+l2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0+lg3.*omega3_1.*omega3_2.*cos(theta3_1).*sin(theta3_2).*2.0));
et130 = lg1.*cos(theta1_2).*sin(theta1_1).*(m2.*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+lg2.*omega2_2.^2.*sin(theta2_2))+m1.*(conj(seg1_top_a_1)+lg1.*omega1_2.^2.*sin(theta1_2))+m3.*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+l2.*omega2_2.^2.*sin(theta2_2)+lg3.*omega3_2.^2.*sin(theta3_2)));
et131 = -sin(theta1_2).*(omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0)+omega1_2.*cos(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_1.^2.*cos(theta1_1).*sin(theta1_3)+omega1_3.^2.*cos(theta1_1).*sin(theta1_3)+omega1_1.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_2.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_1.*omega1_3.*cos(theta1_3).*sin(theta1_1).*2.0-omega1_1.*omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3).*2.0+omega1_2.*omega1_3.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3).*2.0);
et132 = -cos(theta1_2).*sin(theta1_3).*(omega1_1.^2.*cos(theta1_1).*cos(theta1_3)+omega1_3.^2.*cos(theta1_1).*cos(theta1_3)-omega1_1.*omega1_3.*sin(theta1_1).*sin(theta1_3).*2.0-omega1_1.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)-omega1_2.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)-omega1_3.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_1.*omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2).*2.0+omega1_2.*omega1_3.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1).*2.0)-omega1_3.*cos(theta1_2).*cos(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+omega1_2.*cos(theta1_3).*sin(theta1_2).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et133 = omega1_3.*cos(theta1_2).*sin(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+omega1_2.*sin(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2));
et134 = ((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))).*(I1z.*sin(theta1_2).^2+I1x.*cos(theta1_2).^2.*cos(theta1_3).^2+I1y.*cos(theta1_2).^2.*sin(theta1_3).^2);
et135 = (-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et136 = ((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et137 = ((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))).*(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et138 = -((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1));
et139 = (-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1x.*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).^2+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_1).^2.*cos(theta1_2).^2);
et140 = -(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(-omega1_1.^2.*sin(theta1_1).*sin(theta1_3)-omega1_3.^2.*sin(theta1_1).*sin(theta1_3)+omega1_1.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_3.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_1.*omega1_3.*cos(theta1_1).*cos(theta1_3).*2.0+omega1_1.*omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1).*2.0+omega1_2.*omega1_3.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*2.0-omega1_1.*omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3).*2.0);
et141 = -(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.^2.*cos(theta1_3).*sin(theta1_1)+omega1_3.^2.*cos(theta1_3).*sin(theta1_1)+omega1_1.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_3.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_1.*omega1_3.*cos(theta1_1).*sin(theta1_3).*2.0-omega1_2.*omega1_3.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*2.0+omega1_1.*omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2).*2.0)+(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et142 = cos(theta1_2).*sin(theta1_1).*(omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+omega1_2.^2.*cos(theta1_1).*cos(theta1_2)-omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0)-omega1_2.*sin(theta1_1).*sin(theta1_2).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))+omega1_1.*cos(theta1_1).*cos(theta1_2).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2));
et143 = (sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).*(omega1_2.^2.*cos(theta1_2).*cos(theta1_3)+omega1_3.^2.*cos(theta1_2).*cos(theta1_3)-omega1_2.*omega1_3.*sin(theta1_2).*sin(theta1_3).*2.0)-(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_2.^2.*cos(theta1_2).*sin(theta1_3)+omega1_3.^2.*cos(theta1_2).*sin(theta1_3)+omega1_2.*omega1_3.*cos(theta1_3).*sin(theta1_2).*2.0)+(omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et144 = omega1_1.*omega1_2.*cos(theta1_2).^2.*sin(theta1_1)+omega1_2.^2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2).*2.0;
et145 = (I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1)).*(et131+et132+et133)-(-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(et134+et135+et136);
et146 = (l1.*cos(theta1_1).*cos(theta1_2)-lg1.*cos(theta1_1).*cos(theta1_2)).*(m2.*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+lg2.*omega2_2.^2.*sin(theta2_2))+m3.*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+l2.*omega2_2.^2.*sin(theta2_2)+lg3.*omega3_2.^2.*sin(theta3_2)));
et147 = -(m2.*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+lg2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+lg2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-lg2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0)+m3.*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+l2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+l2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)+lg3.*omega3_1.^2.*cos(theta3_1).*cos(theta3_2)+lg3.*omega3_2.^2.*cos(theta3_1).*cos(theta3_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-l2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0-lg3.*omega3_1.*omega3_2.*sin(theta3_1).*sin(theta3_2).*2.0)).*(l1.*sin(theta1_2)-lg1.*sin(theta1_2));
et148 = (et137+et138+et139).*((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2)))+(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))).*(et140+et141+et142);
et149 = (I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).^2+I1y.*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_2).^2.*sin(theta1_1).^2).*(et143+et144);
et150 = -lg1.*sin(theta1_2).*(m1.*(conj(seg1_top_a_3)+lg1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+lg1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)-lg1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0)+m2.*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+lg2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+lg2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-lg2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0)+m3.*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+l2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+l2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)+lg3.*omega3_1.^2.*cos(theta3_1).*cos(theta3_2)+lg3.*omega3_2.^2.*cos(theta3_1).*cos(theta3_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-l2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0-lg3.*omega3_1.*omega3_2.*sin(theta3_1).*sin(theta3_2).*2.0));
et151 = lg1.*cos(theta1_1).*cos(theta1_2).*(m2.*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+lg2.*omega2_2.^2.*sin(theta2_2))+m1.*(conj(seg1_top_a_1)+lg1.*omega1_2.^2.*sin(theta1_2))+m3.*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+l2.*omega2_2.^2.*sin(theta2_2)+lg3.*omega3_2.^2.*sin(theta3_2)));
et152 = -sin(theta1_2).*(omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0)+omega1_2.*cos(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_1.^2.*cos(theta1_1).*sin(theta1_3)+omega1_3.^2.*cos(theta1_1).*sin(theta1_3)+omega1_1.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_2.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_1.*omega1_3.*cos(theta1_3).*sin(theta1_1).*2.0-omega1_1.*omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3).*2.0+omega1_2.*omega1_3.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3).*2.0);
et153 = -cos(theta1_2).*sin(theta1_3).*(omega1_1.^2.*cos(theta1_1).*cos(theta1_3)+omega1_3.^2.*cos(theta1_1).*cos(theta1_3)-omega1_1.*omega1_3.*sin(theta1_1).*sin(theta1_3).*2.0-omega1_1.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)-omega1_2.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)-omega1_3.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_1.*omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2).*2.0+omega1_2.*omega1_3.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1).*2.0)-omega1_3.*cos(theta1_2).*cos(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+omega1_2.*cos(theta1_3).*sin(theta1_2).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et154 = omega1_3.*cos(theta1_2).*sin(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+omega1_2.*sin(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2));
et155 = ((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))).*(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et156 = -((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1));
et157 = (-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1x.*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).^2+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_1).^2.*cos(theta1_2).^2);
et158 = ((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).^2+I1y.*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_2).^2.*sin(theta1_1).^2);
et159 = ((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))).*(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et160 = -(-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1));
et161 = (sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).*(omega1_2.^2.*cos(theta1_2).*cos(theta1_3)+omega1_3.^2.*cos(theta1_2).*cos(theta1_3)-omega1_2.*omega1_3.*sin(theta1_2).*sin(theta1_3).*2.0)-(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_2.^2.*cos(theta1_2).*sin(theta1_3)+omega1_3.^2.*cos(theta1_2).*sin(theta1_3)+omega1_2.*omega1_3.*cos(theta1_3).*sin(theta1_2).*2.0)+(omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et162 = omega1_1.*omega1_2.*cos(theta1_2).^2.*sin(theta1_1)+omega1_2.^2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2).*2.0;
et163 = -(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(-omega1_1.^2.*sin(theta1_1).*sin(theta1_3)-omega1_3.^2.*sin(theta1_1).*sin(theta1_3)+omega1_1.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_3.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_1.*omega1_3.*cos(theta1_1).*cos(theta1_3).*2.0+omega1_1.*omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1).*2.0+omega1_2.*omega1_3.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*2.0-omega1_1.*omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3).*2.0);
et164 = -(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.^2.*cos(theta1_3).*sin(theta1_1)+omega1_3.^2.*cos(theta1_3).*sin(theta1_1)+omega1_1.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_3.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_1.*omega1_3.*cos(theta1_1).*sin(theta1_3).*2.0-omega1_2.*omega1_3.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*2.0+omega1_1.*omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2).*2.0)+(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et165 = cos(theta1_2).*sin(theta1_1).*(omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+omega1_2.^2.*cos(theta1_1).*cos(theta1_2)-omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0)-omega1_2.*sin(theta1_1).*sin(theta1_2).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))+omega1_1.*cos(theta1_1).*cos(theta1_2).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2));
et166 = (I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))).*(et152+et153+et154);
et167 = (l1.*cos(theta1_1).*cos(theta1_2)-lg1.*cos(theta1_1).*cos(theta1_2)).*(m2.*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+lg2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+lg2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+lg2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0)+m3.*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+l2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+l2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+lg3.*omega3_1.^2.*cos(theta3_2).*sin(theta3_1)+lg3.*omega3_2.^2.*cos(theta3_2).*sin(theta3_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+l2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0+lg3.*omega3_1.*omega3_2.*cos(theta3_1).*sin(theta3_2).*2.0));
et168 = -(l1.*cos(theta1_2).*sin(theta1_1)-lg1.*cos(theta1_2).*sin(theta1_1)).*(m2.*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+lg2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+lg2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-lg2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0)+m3.*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+l2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+l2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)+lg3.*omega3_1.^2.*cos(theta3_1).*cos(theta3_2)+lg3.*omega3_2.^2.*cos(theta3_1).*cos(theta3_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-l2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0-lg3.*omega3_1.*omega3_2.*sin(theta3_1).*sin(theta3_2).*2.0));
et169 = ((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(et155+et156+et157)-(-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(et158+et159+et160);
et170 = -(et161+et162).*(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)))-(I1z.*sin(theta1_2).^2+I1x.*cos(theta1_2).^2.*cos(theta1_3).^2+I1y.*cos(theta1_2).^2.*sin(theta1_3).^2).*(et163+et164+et165);
et171 = -lg1.*cos(theta1_2).*sin(theta1_1).*(m1.*(conj(seg1_top_a_3)+lg1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+lg1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)-lg1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0)+m2.*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+lg2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+lg2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-lg2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0)+m3.*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+l2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+l2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)+lg3.*omega3_1.^2.*cos(theta3_1).*cos(theta3_2)+lg3.*omega3_2.^2.*cos(theta3_1).*cos(theta3_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-l2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0-lg3.*omega3_1.*omega3_2.*sin(theta3_1).*sin(theta3_2).*2.0));
et172 = lg1.*cos(theta1_1).*cos(theta1_2).*(m1.*(-conj(seg1_top_a_2)+lg1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+lg1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+lg1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0)+m2.*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+lg2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+lg2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+lg2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0)+m3.*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+l2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+l2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+lg3.*omega3_1.^2.*cos(theta3_2).*sin(theta3_1)+lg3.*omega3_2.^2.*cos(theta3_2).*sin(theta3_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+l2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0+lg3.*omega3_1.*omega3_2.*cos(theta3_1).*sin(theta3_2).*2.0));
V_hirashima = [et166+et167+et168+et169+et170+et171+et172;et145+et146+et147+et148+et149+et150+et151;et125+et126+et127+et128+et129+et130;et105+et106+et107+et108+et109+et110;et86+et87+et88+et89+et90;et67+et68+et69+et70+et71;et49+et50+et51+et52;et32+et33+et34;et15+et16+et17];
