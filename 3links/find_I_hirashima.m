function I_hirashima = find_I_hirashima(I1x,I2x,I3x,I1y,I2y,I3y,I1z,I2z,I3z,l1,l2,lg1,lg2,lg3,m1,m2,m3,theta1_1,theta1_2,theta1_3,theta2_1,theta2_2,theta2_3,theta3_1,theta3_2,theta3_3)
%find_I_hirashima
%    I_hirashima = find_I_hirashima(I1x,I2x,I3x,I1y,I2y,I3y,I1z,I2z,I3z,L1,L2,LG1,LG2,LG3,M1,M2,M3,THETA1_1,THETA1_2,THETA1_3,THETA2_1,THETA2_2,THETA2_3,THETA3_1,THETA3_2,THETA3_3)

%    This function was generated by the Symbolic Math Toolbox version 9.0.
%    16-Jun-2022 15:05:02

et1 = -(l1.*m2.*cos(theta1_1).*cos(theta1_2)+l1.*m3.*cos(theta1_1).*cos(theta1_2)).*(l1.*sin(theta1_2)-lg1.*sin(theta1_2))-(cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_1).*cos(theta1_2).*sin(theta1_2)).*(I1x.*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).^2+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_1).^2.*cos(theta1_2).^2);
et2 = (cos(theta1_2).^2.*sin(theta1_1).^2+(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).^2+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2).*(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)))-lg1.*sin(theta1_2).*(l1.*m2.*cos(theta1_1).*cos(theta1_2)+l1.*m3.*cos(theta1_1).*cos(theta1_2)+lg1.*m1.*cos(theta1_1).*cos(theta1_2));
et3 = -(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1)).*(cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_1).*cos(theta1_2).*sin(theta1_2))+(l1.*m2.*cos(theta1_2).*sin(theta1_1)+l1.*m3.*cos(theta1_2).*sin(theta1_1)).*(l1.*sin(theta1_2)-lg1.*sin(theta1_2));
et4 = -(cos(theta1_2).^2.*sin(theta1_1).^2+(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).^2+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2).*(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)))+lg1.*sin(theta1_2).*(l1.*m2.*cos(theta1_2).*sin(theta1_1)+l1.*m3.*cos(theta1_2).*sin(theta1_1)+lg1.*m1.*cos(theta1_2).*sin(theta1_1));
et5 = (l1.*m2.*cos(theta1_2).*sin(theta1_1)+l1.*m3.*cos(theta1_2).*sin(theta1_1)).*(l1.*cos(theta1_2).*sin(theta1_1)-lg1.*cos(theta1_2).*sin(theta1_1))-(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))).*(cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_1).*cos(theta1_2).*sin(theta1_2))+(l1.*m2.*cos(theta1_1).*cos(theta1_2)+l1.*m3.*cos(theta1_1).*cos(theta1_2)).*(l1.*cos(theta1_1).*cos(theta1_2)-lg1.*cos(theta1_1).*cos(theta1_2));
et6 = (cos(theta1_2).^2.*sin(theta1_1).^2+(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).^2+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2).*(I1z.*sin(theta1_2).^2+I1x.*cos(theta1_2).^2.*cos(theta1_3).^2+I1y.*cos(theta1_2).^2.*sin(theta1_3).^2)+lg1.*cos(theta1_1).*cos(theta1_2).*(l1.*m2.*cos(theta1_1).*cos(theta1_2)+l1.*m3.*cos(theta1_1).*cos(theta1_2)+lg1.*m1.*cos(theta1_1).*cos(theta1_2))+lg1.*cos(theta1_2).*sin(theta1_1).*(l1.*m2.*cos(theta1_2).*sin(theta1_1)+l1.*m3.*cos(theta1_2).*sin(theta1_1)+lg1.*m1.*cos(theta1_2).*sin(theta1_1));
et7 = (l1.*cos(theta1_2).*sin(theta1_1)-lg1.*cos(theta1_2).*sin(theta1_1)).*(l1.*m2.*cos(theta1_2)+l1.*m3.*cos(theta1_2))+(sin(theta1_1).*sin(theta1_2).^2+cos(theta1_2).^2.*cos(theta1_3).^2.*sin(theta1_1)+cos(theta1_2).^2.*sin(theta1_1).*sin(theta1_3).^2).*(I1x.*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).^2+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_1).^2.*cos(theta1_2).^2)+(l1.*m2.*sin(theta1_1).*sin(theta1_2)+l1.*m3.*sin(theta1_1).*sin(theta1_2)).*(l1.*sin(theta1_2)-lg1.*sin(theta1_2));
et8 = (cos(theta1_1).*cos(theta1_2).^2-cos(theta1_3).*sin(theta1_2).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+sin(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1));
et9 = (-cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_1).*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)).*(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)))+lg1.*sin(theta1_2).*(l1.*m2.*sin(theta1_1).*sin(theta1_2)+l1.*m3.*sin(theta1_1).*sin(theta1_2)+lg1.*m1.*sin(theta1_1).*sin(theta1_2))+lg1.*cos(theta1_2).*sin(theta1_1).*(l1.*m2.*cos(theta1_2)+l1.*m3.*cos(theta1_2)+lg1.*m1.*cos(theta1_2));
et10 = -(-cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_1).*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)).*(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et11 = (cos(theta1_1).*cos(theta1_2).^2-cos(theta1_3).*sin(theta1_2).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+sin(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).^2+I1y.*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_2).^2.*sin(theta1_1).^2)+(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1)).*(sin(theta1_1).*sin(theta1_2).^2+cos(theta1_2).^2.*cos(theta1_3).^2.*sin(theta1_1)+cos(theta1_2).^2.*sin(theta1_1).*sin(theta1_3).^2);
et12 = (l1.*cos(theta1_1).*cos(theta1_2)-lg1.*cos(theta1_1).*cos(theta1_2)).*(l1.*m2.*cos(theta1_2)+l1.*m3.*cos(theta1_2))+(l1.*m2.*cos(theta1_1).*sin(theta1_2)+l1.*m3.*cos(theta1_1).*sin(theta1_2)).*(l1.*sin(theta1_2)-lg1.*sin(theta1_2))+lg1.*sin(theta1_2).*(l1.*m2.*cos(theta1_1).*sin(theta1_2)+l1.*m3.*cos(theta1_1).*sin(theta1_2)+lg1.*m1.*cos(theta1_1).*sin(theta1_2))+lg1.*cos(theta1_1).*cos(theta1_2).*(l1.*m2.*cos(theta1_2)+l1.*m3.*cos(theta1_2)+lg1.*m1.*cos(theta1_2));
et13 = -(cos(theta1_1).*cos(theta1_2).^2-cos(theta1_3).*sin(theta1_2).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+sin(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))).*(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)))+(-cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_1).*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)).*(I1z.*sin(theta1_2).^2+I1x.*cos(theta1_2).^2.*cos(theta1_3).^2+I1y.*cos(theta1_2).^2.*sin(theta1_3).^2);
et14 = (l1.*m2.*cos(theta1_1).*sin(theta1_2)+l1.*m3.*cos(theta1_1).*sin(theta1_2)).*(l1.*cos(theta1_2).*sin(theta1_1)-lg1.*cos(theta1_2).*sin(theta1_1))-(l1.*cos(theta1_1).*cos(theta1_2)-lg1.*cos(theta1_1).*cos(theta1_2)).*(l1.*m2.*sin(theta1_1).*sin(theta1_2)+l1.*m3.*sin(theta1_1).*sin(theta1_2))+(sin(theta1_1).*sin(theta1_2).^2+cos(theta1_2).^2.*cos(theta1_3).^2.*sin(theta1_1)+cos(theta1_2).^2.*sin(theta1_1).*sin(theta1_3).^2).*(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)))+lg1.*cos(theta1_2).*sin(theta1_1).*(l1.*m2.*cos(theta1_1).*sin(theta1_2)+l1.*m3.*cos(theta1_1).*sin(theta1_2)+lg1.*m1.*cos(theta1_1).*sin(theta1_2));
et15 = -lg1.*cos(theta1_1).*cos(theta1_2).*(l1.*m2.*sin(theta1_1).*sin(theta1_2)+l1.*m3.*sin(theta1_1).*sin(theta1_2)+lg1.*m1.*sin(theta1_1).*sin(theta1_2));
et16 = -(cos(theta1_2).*cos(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1));
et17 = (cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1x.*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).^2+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_1).^2.*cos(theta1_2).^2)+((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))).*(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et18 = -((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))).*(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et19 = (cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1));
et20 = -(cos(theta1_2).*cos(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).^2+I1y.*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_2).^2.*sin(theta1_1).^2);
et21 = ((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))).*(I1z.*sin(theta1_2).^2+I1x.*cos(theta1_2).^2.*cos(theta1_3).^2+I1y.*cos(theta1_2).^2.*sin(theta1_3).^2)+(cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et22 = (cos(theta1_2).*cos(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))).*(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et23 = -(cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_1).*cos(theta2_2).*sin(theta2_2)).*(I2x.*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2)).^2+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).^2+I2z.*cos(theta2_1).^2.*cos(theta2_2).^2)+(cos(theta2_2).^2.*sin(theta2_1).^2+(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).^2+(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).^2).*(I2z.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2)+I2x.*cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et24 = -lg2.*sin(theta2_2).*(l2.*m3.*cos(theta2_1).*cos(theta2_2)+lg2.*m2.*cos(theta2_1).*cos(theta2_2))-l2.*m3.*cos(theta2_1).*cos(theta2_2).*(l2.*sin(theta2_2)-lg2.*sin(theta2_2));
et25 = -(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))-I2z.*cos(theta2_1).*cos(theta2_2).^2.*sin(theta2_1)).*(cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_1).*cos(theta2_2).*sin(theta2_2));
et26 = -(cos(theta2_2).^2.*sin(theta2_1).^2+(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).^2+(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).^2).*(I2z.*cos(theta2_2).*sin(theta2_1).*sin(theta2_2)-I2x.*cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)))+lg2.*sin(theta2_2).*(l2.*m3.*cos(theta2_2).*sin(theta2_1)+lg2.*m2.*cos(theta2_2).*sin(theta2_1))+l2.*m3.*cos(theta2_2).*sin(theta2_1).*(l2.*sin(theta2_2)-lg2.*sin(theta2_2));
et27 = -(I2z.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2)+I2x.*cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))).*(cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_1).*cos(theta2_2).*sin(theta2_2))+(cos(theta2_2).^2.*sin(theta2_1).^2+(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).^2+(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).^2).*(I2z.*sin(theta2_2).^2+I2x.*cos(theta2_2).^2.*cos(theta2_3).^2+I2y.*cos(theta2_2).^2.*sin(theta2_3).^2)+lg2.*cos(theta2_1).*cos(theta2_2).*(l2.*m3.*cos(theta2_1).*cos(theta2_2)+lg2.*m2.*cos(theta2_1).*cos(theta2_2));
et28 = lg2.*cos(theta2_2).*sin(theta2_1).*(l2.*m3.*cos(theta2_2).*sin(theta2_1)+lg2.*m2.*cos(theta2_2).*sin(theta2_1))+l2.*m3.*cos(theta2_1).*cos(theta2_2).*(l2.*cos(theta2_1).*cos(theta2_2)-lg2.*cos(theta2_1).*cos(theta2_2))+l2.*m3.*cos(theta2_2).*sin(theta2_1).*(l2.*cos(theta2_2).*sin(theta2_1)-lg2.*cos(theta2_2).*sin(theta2_1));
et29 = (sin(theta2_1).*sin(theta2_2).^2+cos(theta2_2).^2.*cos(theta2_3).^2.*sin(theta2_1)+cos(theta2_2).^2.*sin(theta2_1).*sin(theta2_3).^2).*(I2x.*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2)).^2+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).^2+I2z.*cos(theta2_1).^2.*cos(theta2_2).^2)+(cos(theta2_1).*cos(theta2_2).^2-cos(theta2_3).*sin(theta2_2).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+sin(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))).*(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))-I2z.*cos(theta2_1).*cos(theta2_2).^2.*sin(theta2_1));
et30 = (-cos(theta2_1).*cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+cos(theta2_1).*cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_1).*cos(theta2_2).*sin(theta2_1).*sin(theta2_2)).*(I2z.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2)+I2x.*cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)))+lg2.*sin(theta2_2).*(l2.*m3.*sin(theta2_1).*sin(theta2_2)+lg2.*m2.*sin(theta2_1).*sin(theta2_2))+lg2.*cos(theta2_2).*sin(theta2_1).*(l2.*m3.*cos(theta2_2)+lg2.*m2.*cos(theta2_2))+l2.*m3.*cos(theta2_2).*(l2.*cos(theta2_2).*sin(theta2_1)-lg2.*cos(theta2_2).*sin(theta2_1))+l2.*m3.*sin(theta2_1).*sin(theta2_2).*(l2.*sin(theta2_2)-lg2.*sin(theta2_2));
et31 = -(-cos(theta2_1).*cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+cos(theta2_1).*cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_1).*cos(theta2_2).*sin(theta2_1).*sin(theta2_2)).*(I2z.*cos(theta2_2).*sin(theta2_1).*sin(theta2_2)-I2x.*cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et32 = (cos(theta2_1).*cos(theta2_2).^2-cos(theta2_3).*sin(theta2_2).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+sin(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))).*(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).^2+I2y.*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).^2+I2z.*cos(theta2_2).^2.*sin(theta2_1).^2)+(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))-I2z.*cos(theta2_1).*cos(theta2_2).^2.*sin(theta2_1)).*(sin(theta2_1).*sin(theta2_2).^2+cos(theta2_2).^2.*cos(theta2_3).^2.*sin(theta2_1)+cos(theta2_2).^2.*sin(theta2_1).*sin(theta2_3).^2);
et33 = lg2.*sin(theta2_2).*(l2.*m3.*cos(theta2_1).*sin(theta2_2)+lg2.*m2.*cos(theta2_1).*sin(theta2_2))+l2.*m3.*cos(theta2_2).*(l2.*cos(theta2_1).*cos(theta2_2)-lg2.*cos(theta2_1).*cos(theta2_2))+lg2.*cos(theta2_1).*cos(theta2_2).*(l2.*m3.*cos(theta2_2)+lg2.*m2.*cos(theta2_2))+l2.*m3.*cos(theta2_1).*sin(theta2_2).*(l2.*sin(theta2_2)-lg2.*sin(theta2_2));
et34 = -(cos(theta2_1).*cos(theta2_2).^2-cos(theta2_3).*sin(theta2_2).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+sin(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))).*(I2z.*cos(theta2_2).*sin(theta2_1).*sin(theta2_2)-I2x.*cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)))+(-cos(theta2_1).*cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+cos(theta2_1).*cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_1).*cos(theta2_2).*sin(theta2_1).*sin(theta2_2)).*(I2z.*sin(theta2_2).^2+I2x.*cos(theta2_2).^2.*cos(theta2_3).^2+I2y.*cos(theta2_2).^2.*sin(theta2_3).^2);
et35 = (sin(theta2_1).*sin(theta2_2).^2+cos(theta2_2).^2.*cos(theta2_3).^2.*sin(theta2_1)+cos(theta2_2).^2.*sin(theta2_1).*sin(theta2_3).^2).*(I2z.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2)+I2x.*cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)))+lg2.*cos(theta2_2).*sin(theta2_1).*(l2.*m3.*cos(theta2_1).*sin(theta2_2)+lg2.*m2.*cos(theta2_1).*sin(theta2_2))-lg2.*cos(theta2_1).*cos(theta2_2).*(l2.*m3.*sin(theta2_1).*sin(theta2_2)+lg2.*m2.*sin(theta2_1).*sin(theta2_2))-l2.*m3.*sin(theta2_1).*sin(theta2_2).*(l2.*cos(theta2_1).*cos(theta2_2)-lg2.*cos(theta2_1).*cos(theta2_2))+l2.*m3.*cos(theta2_1).*sin(theta2_2).*(l2.*cos(theta2_2).*sin(theta2_1)-lg2.*cos(theta2_2).*sin(theta2_1));
et36 = -(cos(theta2_2).*cos(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))).*(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))-I2z.*cos(theta2_1).*cos(theta2_2).^2.*sin(theta2_1));
et37 = (cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))).*(I2x.*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2)).^2+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).^2+I2z.*cos(theta2_1).^2.*cos(theta2_2).^2)+((cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))-(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))).*(I2z.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2)+I2x.*cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et38 = -((cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))-(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))).*(I2z.*cos(theta2_2).*sin(theta2_1).*sin(theta2_2)-I2x.*cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et39 = (cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))).*(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))-I2z.*cos(theta2_1).*cos(theta2_2).^2.*sin(theta2_1));
et40 = -(cos(theta2_2).*cos(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))).*(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).^2+I2y.*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).^2+I2z.*cos(theta2_2).^2.*sin(theta2_1).^2);
et41 = ((cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))-(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))).*(I2z.*sin(theta2_2).^2+I2x.*cos(theta2_2).^2.*cos(theta2_3).^2+I2y.*cos(theta2_2).^2.*sin(theta2_3).^2)+(cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))).*(I2z.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2)+I2x.*cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et42 = (cos(theta2_2).*cos(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))).*(I2z.*cos(theta2_2).*sin(theta2_1).*sin(theta2_2)-I2x.*cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et43 = -(cos(theta3_2).*cos(theta3_3).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))-cos(theta3_2).*sin(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_1).*cos(theta3_2).*sin(theta3_2)).*(I3x.*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2)).^2+I3y.*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).^2+I3z.*cos(theta3_1).^2.*cos(theta3_2).^2)+(cos(theta3_2).^2.*sin(theta3_1).^2+(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).^2+(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).^2).*(I3z.*cos(theta3_1).*cos(theta3_2).*sin(theta3_2)+I3x.*cos(theta3_2).*cos(theta3_3).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))-I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)));
et44 = -lg3.^2.*m3.*cos(theta3_1).*cos(theta3_2).*sin(theta3_2);
et45 = -(I3x.*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+I3y.*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3))-I3z.*cos(theta3_1).*cos(theta3_2).^2.*sin(theta3_1)).*(cos(theta3_2).*cos(theta3_3).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))-cos(theta3_2).*sin(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_1).*cos(theta3_2).*sin(theta3_2));
et46 = -(cos(theta3_2).^2.*sin(theta3_1).^2+(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).^2+(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).^2).*(I3z.*cos(theta3_2).*sin(theta3_1).*sin(theta3_2)-I3x.*cos(theta3_2).*cos(theta3_3).*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2))+I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)))+lg3.^2.*m3.*cos(theta3_2).*sin(theta3_1).*sin(theta3_2);
et47 = (sin(theta3_1).*sin(theta3_2).^2+cos(theta3_2).^2.*cos(theta3_3).^2.*sin(theta3_1)+cos(theta3_2).^2.*sin(theta3_1).*sin(theta3_3).^2).*(I3x.*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2)).^2+I3y.*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).^2+I3z.*cos(theta3_1).^2.*cos(theta3_2).^2)+(cos(theta3_1).*cos(theta3_2).^2-cos(theta3_3).*sin(theta3_2).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+sin(theta3_2).*sin(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))).*(I3x.*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+I3y.*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3))-I3z.*cos(theta3_1).*cos(theta3_2).^2.*sin(theta3_1));
et48 = (-cos(theta3_1).*cos(theta3_2).*cos(theta3_3).*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2))+cos(theta3_1).*cos(theta3_2).*sin(theta3_3).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_1).*cos(theta3_2).*sin(theta3_1).*sin(theta3_2)).*(I3z.*cos(theta3_1).*cos(theta3_2).*sin(theta3_2)+I3x.*cos(theta3_2).*cos(theta3_3).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))-I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)))+lg3.^2.*m3.*cos(theta3_2).^2.*sin(theta3_1)+lg3.^2.*m3.*sin(theta3_1).*sin(theta3_2).^2;
et49 = -(-cos(theta3_1).*cos(theta3_2).*cos(theta3_3).*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2))+cos(theta3_1).*cos(theta3_2).*sin(theta3_3).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_1).*cos(theta3_2).*sin(theta3_1).*sin(theta3_2)).*(I3z.*cos(theta3_2).*sin(theta3_1).*sin(theta3_2)-I3x.*cos(theta3_2).*cos(theta3_3).*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2))+I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)));
et50 = (cos(theta3_1).*cos(theta3_2).^2-cos(theta3_3).*sin(theta3_2).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+sin(theta3_2).*sin(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))).*(I3x.*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).^2+I3y.*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).^2+I3z.*cos(theta3_2).^2.*sin(theta3_1).^2)+(I3x.*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+I3y.*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3))-I3z.*cos(theta3_1).*cos(theta3_2).^2.*sin(theta3_1)).*(sin(theta3_1).*sin(theta3_2).^2+cos(theta3_2).^2.*cos(theta3_3).^2.*sin(theta3_1)+cos(theta3_2).^2.*sin(theta3_1).*sin(theta3_3).^2);
et51 = lg3.^2.*m3.*cos(theta3_1).*cos(theta3_2).^2+lg3.^2.*m3.*cos(theta3_1).*sin(theta3_2).^2;
et52 = -(cos(theta3_1).*cos(theta3_2).^2-cos(theta3_3).*sin(theta3_2).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+sin(theta3_2).*sin(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))).*(I3z.*cos(theta3_2).*sin(theta3_1).*sin(theta3_2)-I3x.*cos(theta3_2).*cos(theta3_3).*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2))+I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)))+(-cos(theta3_1).*cos(theta3_2).*cos(theta3_3).*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2))+cos(theta3_1).*cos(theta3_2).*sin(theta3_3).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_1).*cos(theta3_2).*sin(theta3_1).*sin(theta3_2)).*(I3z.*sin(theta3_2).^2+I3x.*cos(theta3_2).^2.*cos(theta3_3).^2+I3y.*cos(theta3_2).^2.*sin(theta3_3).^2);
et53 = (sin(theta3_1).*sin(theta3_2).^2+cos(theta3_2).^2.*cos(theta3_3).^2.*sin(theta3_1)+cos(theta3_2).^2.*sin(theta3_1).*sin(theta3_3).^2).*(I3z.*cos(theta3_1).*cos(theta3_2).*sin(theta3_2)+I3x.*cos(theta3_2).*cos(theta3_3).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))-I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)));
et54 = -(cos(theta3_2).*cos(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_3).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))).*(I3x.*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+I3y.*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3))-I3z.*cos(theta3_1).*cos(theta3_2).^2.*sin(theta3_1));
et55 = (cos(theta3_2).*cos(theta3_3).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_3).*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2))).*(I3x.*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2)).^2+I3y.*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).^2+I3z.*cos(theta3_1).^2.*cos(theta3_2).^2)+((cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))-(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))).*(I3z.*cos(theta3_1).*cos(theta3_2).*sin(theta3_2)+I3x.*cos(theta3_2).*cos(theta3_3).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))-I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)));
et56 = -((cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))-(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))).*(I3z.*cos(theta3_2).*sin(theta3_1).*sin(theta3_2)-I3x.*cos(theta3_2).*cos(theta3_3).*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2))+I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)));
et57 = (cos(theta3_2).*cos(theta3_3).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_3).*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2))).*(I3x.*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))+I3y.*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3))-I3z.*cos(theta3_1).*cos(theta3_2).^2.*sin(theta3_1));
et58 = -(cos(theta3_2).*cos(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_3).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))).*(I3x.*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).^2+I3y.*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).^2+I3z.*cos(theta3_2).^2.*sin(theta3_1).^2);
et59 = ((cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))-(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))).*(I3z.*sin(theta3_2).^2+I3x.*cos(theta3_2).^2.*cos(theta3_3).^2+I3y.*cos(theta3_2).^2.*sin(theta3_3).^2)+(cos(theta3_2).*cos(theta3_3).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_3).*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2))).*(I3z.*cos(theta3_1).*cos(theta3_2).*sin(theta3_2)+I3x.*cos(theta3_2).*cos(theta3_3).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))-I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3)));
et60 = (cos(theta3_2).*cos(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_2).*sin(theta3_3).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))).*(I3z.*cos(theta3_2).*sin(theta3_1).*sin(theta3_2)-I3x.*cos(theta3_2).*cos(theta3_3).*(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2))+I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)));
mt1 = [et5+et6,et3+et4,et1+et2,lg2.*cos(theta2_1).*cos(theta2_2).*(l1.*m2.*cos(theta1_1).*cos(theta1_2)+l1.*m3.*cos(theta1_1).*cos(theta1_2))+lg2.*cos(theta2_2).*sin(theta2_1).*(l1.*m2.*cos(theta1_2).*sin(theta1_1)+l1.*m3.*cos(theta1_2).*sin(theta1_1))+l1.*m3.*cos(theta1_1).*cos(theta1_2).*(l2.*cos(theta2_1).*cos(theta2_2)-lg2.*cos(theta2_1).*cos(theta2_2))+l1.*m3.*cos(theta1_2).*sin(theta1_1).*(l2.*cos(theta2_2).*sin(theta2_1)-lg2.*cos(theta2_2).*sin(theta2_1)),lg2.*sin(theta2_2).*(l1.*m2.*cos(theta1_2).*sin(theta1_1)+l1.*m3.*cos(theta1_2).*sin(theta1_1))+l1.*m3.*cos(theta1_2).*sin(theta1_1).*(l2.*sin(theta2_2)-lg2.*sin(theta2_2)),-lg2.*sin(theta2_2).*(l1.*m2.*cos(theta1_1).*cos(theta1_2)+l1.*m3.*cos(theta1_1).*cos(theta1_2))-l1.*m3.*cos(theta1_1).*cos(theta1_2).*(l2.*sin(theta2_2)-lg2.*sin(theta2_2))];
mt2 = [l1.*lg3.*m3.*cos(theta1_1).*cos(theta1_2).*cos(theta3_1).*cos(theta3_2)+l1.*lg3.*m3.*cos(theta1_2).*cos(theta3_2).*sin(theta1_1).*sin(theta3_1),l1.*lg3.*m3.*cos(theta1_2).*sin(theta1_1).*sin(theta3_2),-l1.*lg3.*m3.*cos(theta1_1).*cos(theta1_2).*sin(theta3_2),et13+et14+et15,et10+et11+et12,et7+et8+et9,lg2.*cos(theta2_2).*sin(theta2_1).*(l1.*m2.*cos(theta1_1).*sin(theta1_2)+l1.*m3.*cos(theta1_1).*sin(theta1_2))-lg2.*cos(theta2_1).*cos(theta2_2).*(l1.*m2.*sin(theta1_1).*sin(theta1_2)+l1.*m3.*sin(theta1_1).*sin(theta1_2))-l1.*m3.*sin(theta1_1).*sin(theta1_2).*(l2.*cos(theta2_1).*cos(theta2_2)-lg2.*cos(theta2_1).*cos(theta2_2))+l1.*m3.*cos(theta1_1).*sin(theta1_2).*(l2.*cos(theta2_2).*sin(theta2_1)-lg2.*cos(theta2_2).*sin(theta2_1))];
mt3 = [lg2.*sin(theta2_2).*(l1.*m2.*cos(theta1_1).*sin(theta1_2)+l1.*m3.*cos(theta1_1).*sin(theta1_2))+l1.*m3.*cos(theta1_2).*(l2.*cos(theta2_1).*cos(theta2_2)-lg2.*cos(theta2_1).*cos(theta2_2))+lg2.*cos(theta2_1).*cos(theta2_2).*(l1.*m2.*cos(theta1_2)+l1.*m3.*cos(theta1_2))+l1.*m3.*cos(theta1_1).*sin(theta1_2).*(l2.*sin(theta2_2)-lg2.*sin(theta2_2)),lg2.*sin(theta2_2).*(l1.*m2.*sin(theta1_1).*sin(theta1_2)+l1.*m3.*sin(theta1_1).*sin(theta1_2))+lg2.*cos(theta2_2).*sin(theta2_1).*(l1.*m2.*cos(theta1_2)+l1.*m3.*cos(theta1_2))+l1.*m3.*cos(theta1_2).*(l2.*cos(theta2_2).*sin(theta2_1)-lg2.*cos(theta2_2).*sin(theta2_1))+l1.*m3.*sin(theta1_1).*sin(theta1_2).*(l2.*sin(theta2_2)-lg2.*sin(theta2_2)),l1.*lg3.*m3.*cos(theta1_1).*cos(theta3_2).*sin(theta1_2).*sin(theta3_1)-l1.*lg3.*m3.*cos(theta3_1).*cos(theta3_2).*sin(theta1_1).*sin(theta1_2),l1.*lg3.*m3.*cos(theta1_2).*cos(theta3_1).*cos(theta3_2)+l1.*lg3.*m3.*cos(theta1_1).*sin(theta1_2).*sin(theta3_2)];
mt4 = [l1.*lg3.*m3.*cos(theta1_2).*cos(theta3_2).*sin(theta3_1)+l1.*lg3.*m3.*sin(theta1_1).*sin(theta1_2).*sin(theta3_2),et21+et22,et18+et19+et20,et16+et17,0.0,0.0,0.0,0.0,0.0,0.0,(l2.*m3.*cos(theta2_2).*sin(theta2_1)+lg2.*m2.*cos(theta2_2).*sin(theta2_1)).*(l1.*cos(theta1_2).*sin(theta1_1)-lg1.*cos(theta1_2).*sin(theta1_1))+(l2.*m3.*cos(theta2_1).*cos(theta2_2)+lg2.*m2.*cos(theta2_1).*cos(theta2_2)).*(l1.*cos(theta1_1).*cos(theta1_2)-lg1.*cos(theta1_1).*cos(theta1_2))+lg1.*cos(theta1_1).*cos(theta1_2).*(l2.*m3.*cos(theta2_1).*cos(theta2_2)+lg2.*m2.*cos(theta2_1).*cos(theta2_2))+lg1.*cos(theta1_2).*sin(theta1_1).*(l2.*m3.*cos(theta2_2).*sin(theta2_1)+lg2.*m2.*cos(theta2_2).*sin(theta2_1)),(l2.*m3.*cos(theta2_2).*sin(theta2_1)+lg2.*m2.*cos(theta2_2).*sin(theta2_1)).*(l1.*sin(theta1_2)-lg1.*sin(theta1_2))+lg1.*sin(theta1_2).*(l2.*m3.*cos(theta2_2).*sin(theta2_1)+lg2.*m2.*cos(theta2_2).*sin(theta2_1))];
mt5 = [-(l2.*m3.*cos(theta2_1).*cos(theta2_2)+lg2.*m2.*cos(theta2_1).*cos(theta2_2)).*(l1.*sin(theta1_2)-lg1.*sin(theta1_2))-lg1.*sin(theta1_2).*(l2.*m3.*cos(theta2_1).*cos(theta2_2)+lg2.*m2.*cos(theta2_1).*cos(theta2_2)),et27+et28,et25+et26,et23+et24,l2.*lg3.*m3.*cos(theta2_1).*cos(theta2_2).*cos(theta3_1).*cos(theta3_2)+l2.*lg3.*m3.*cos(theta2_2).*cos(theta3_2).*sin(theta2_1).*sin(theta3_1),l2.*lg3.*m3.*cos(theta2_2).*sin(theta2_1).*sin(theta3_2),-l2.*lg3.*m3.*cos(theta2_1).*cos(theta2_2).*sin(theta3_2)];
mt6 = [(l2.*m3.*cos(theta2_1).*sin(theta2_2)+lg2.*m2.*cos(theta2_1).*sin(theta2_2)).*(l1.*cos(theta1_2).*sin(theta1_1)-lg1.*cos(theta1_2).*sin(theta1_1))-(l1.*cos(theta1_1).*cos(theta1_2)-lg1.*cos(theta1_1).*cos(theta1_2)).*(l2.*m3.*sin(theta2_1).*sin(theta2_2)+lg2.*m2.*sin(theta2_1).*sin(theta2_2))+lg1.*cos(theta1_2).*sin(theta1_1).*(l2.*m3.*cos(theta2_1).*sin(theta2_2)+lg2.*m2.*cos(theta2_1).*sin(theta2_2))-lg1.*cos(theta1_1).*cos(theta1_2).*(l2.*m3.*sin(theta2_1).*sin(theta2_2)+lg2.*m2.*sin(theta2_1).*sin(theta2_2)),(l1.*cos(theta1_1).*cos(theta1_2)-lg1.*cos(theta1_1).*cos(theta1_2)).*(l2.*m3.*cos(theta2_2)+lg2.*m2.*cos(theta2_2))+(l2.*m3.*cos(theta2_1).*sin(theta2_2)+lg2.*m2.*cos(theta2_1).*sin(theta2_2)).*(l1.*sin(theta1_2)-lg1.*sin(theta1_2))+lg1.*sin(theta1_2).*(l2.*m3.*cos(theta2_1).*sin(theta2_2)+lg2.*m2.*cos(theta2_1).*sin(theta2_2))+lg1.*cos(theta1_1).*cos(theta1_2).*(l2.*m3.*cos(theta2_2)+lg2.*m2.*cos(theta2_2))];
mt7 = [(l1.*cos(theta1_2).*sin(theta1_1)-lg1.*cos(theta1_2).*sin(theta1_1)).*(l2.*m3.*cos(theta2_2)+lg2.*m2.*cos(theta2_2))+(l2.*m3.*sin(theta2_1).*sin(theta2_2)+lg2.*m2.*sin(theta2_1).*sin(theta2_2)).*(l1.*sin(theta1_2)-lg1.*sin(theta1_2))+lg1.*sin(theta1_2).*(l2.*m3.*sin(theta2_1).*sin(theta2_2)+lg2.*m2.*sin(theta2_1).*sin(theta2_2))+lg1.*cos(theta1_2).*sin(theta1_1).*(l2.*m3.*cos(theta2_2)+lg2.*m2.*cos(theta2_2)),et34+et35,et31+et32+et33,et29+et30,l2.*lg3.*m3.*cos(theta2_1).*cos(theta3_2).*sin(theta2_2).*sin(theta3_1)-l2.*lg3.*m3.*cos(theta3_1).*cos(theta3_2).*sin(theta2_1).*sin(theta2_2),l2.*lg3.*m3.*cos(theta2_2).*cos(theta3_1).*cos(theta3_2)+l2.*lg3.*m3.*cos(theta2_1).*sin(theta2_2).*sin(theta3_2),l2.*lg3.*m3.*cos(theta2_2).*cos(theta3_2).*sin(theta3_1)+l2.*lg3.*m3.*sin(theta2_1).*sin(theta2_2).*sin(theta3_2),0.0,0.0,0.0,et41+et42,et38+et39+et40,et36+et37,0.0,0.0,0.0];
mt8 = [lg3.*m3.*cos(theta3_1).*cos(theta3_2).*(l1.*cos(theta1_1).*cos(theta1_2)-lg1.*cos(theta1_1).*cos(theta1_2))+lg3.*m3.*cos(theta3_2).*sin(theta3_1).*(l1.*cos(theta1_2).*sin(theta1_1)-lg1.*cos(theta1_2).*sin(theta1_1))+lg1.*lg3.*m3.*cos(theta1_1).*cos(theta1_2).*cos(theta3_1).*cos(theta3_2)+lg1.*lg3.*m3.*cos(theta1_2).*cos(theta3_2).*sin(theta1_1).*sin(theta3_1),lg3.*m3.*cos(theta3_2).*sin(theta3_1).*(l1.*sin(theta1_2)-lg1.*sin(theta1_2))+lg1.*lg3.*m3.*cos(theta3_2).*sin(theta1_2).*sin(theta3_1),-lg3.*m3.*cos(theta3_1).*cos(theta3_2).*(l1.*sin(theta1_2)-lg1.*sin(theta1_2))-lg1.*lg3.*m3.*cos(theta3_1).*cos(theta3_2).*sin(theta1_2),lg3.*m3.*cos(theta3_1).*cos(theta3_2).*(l2.*cos(theta2_1).*cos(theta2_2)-lg2.*cos(theta2_1).*cos(theta2_2))+lg3.*m3.*cos(theta3_2).*sin(theta3_1).*(l2.*cos(theta2_2).*sin(theta2_1)-lg2.*cos(theta2_2).*sin(theta2_1))+lg2.*lg3.*m3.*cos(theta2_1).*cos(theta2_2).*cos(theta3_1).*cos(theta3_2)+lg2.*lg3.*m3.*cos(theta2_2).*cos(theta3_2).*sin(theta2_1).*sin(theta3_1)];
mt9 = [lg3.*m3.*cos(theta3_2).*sin(theta3_1).*(l2.*sin(theta2_2)-lg2.*sin(theta2_2))+lg2.*lg3.*m3.*cos(theta3_2).*sin(theta2_2).*sin(theta3_1),-lg3.*m3.*cos(theta3_1).*cos(theta3_2).*(l2.*sin(theta2_2)-lg2.*sin(theta2_2))-lg2.*lg3.*m3.*cos(theta3_1).*cos(theta3_2).*sin(theta2_2)];
mt10 = [-(I3z.*cos(theta3_1).*cos(theta3_2).*sin(theta3_2)+I3x.*cos(theta3_2).*cos(theta3_3).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))-I3y.*cos(theta3_2).*sin(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))).*(cos(theta3_2).*cos(theta3_3).*(sin(theta3_1).*sin(theta3_3)-cos(theta3_1).*cos(theta3_3).*sin(theta3_2))-cos(theta3_2).*sin(theta3_3).*(cos(theta3_3).*sin(theta3_1)+cos(theta3_1).*sin(theta3_2).*sin(theta3_3))+cos(theta3_1).*cos(theta3_2).*sin(theta3_2))+(cos(theta3_2).^2.*sin(theta3_1).^2+(cos(theta3_1).*sin(theta3_3)+cos(theta3_3).*sin(theta3_1).*sin(theta3_2)).^2+(cos(theta3_1).*cos(theta3_3)-sin(theta3_1).*sin(theta3_2).*sin(theta3_3)).^2).*(I3z.*sin(theta3_2).^2+I3x.*cos(theta3_2).^2.*cos(theta3_3).^2+I3y.*cos(theta3_2).^2.*sin(theta3_3).^2)+lg3.^2.*m3.*cos(theta3_1).^2.*cos(theta3_2).^2+lg3.^2.*m3.*cos(theta3_2).^2.*sin(theta3_1).^2];
mt11 = [et45+et46,et43+et44,-lg3.*m3.*sin(theta3_1).*sin(theta3_2).*(l1.*cos(theta1_1).*cos(theta1_2)-lg1.*cos(theta1_1).*cos(theta1_2))+lg3.*m3.*cos(theta3_1).*sin(theta3_2).*(l1.*cos(theta1_2).*sin(theta1_1)-lg1.*cos(theta1_2).*sin(theta1_1))-lg1.*lg3.*m3.*cos(theta1_1).*cos(theta1_2).*sin(theta3_1).*sin(theta3_2)+lg1.*lg3.*m3.*cos(theta1_2).*cos(theta3_1).*sin(theta1_1).*sin(theta3_2),lg3.*m3.*cos(theta3_2).*(l1.*cos(theta1_1).*cos(theta1_2)-lg1.*cos(theta1_1).*cos(theta1_2))+lg3.*m3.*cos(theta3_1).*sin(theta3_2).*(l1.*sin(theta1_2)-lg1.*sin(theta1_2))+lg1.*lg3.*m3.*cos(theta1_1).*cos(theta1_2).*cos(theta3_2)+lg1.*lg3.*m3.*cos(theta3_1).*sin(theta1_2).*sin(theta3_2),lg3.*m3.*cos(theta3_2).*(l1.*cos(theta1_2).*sin(theta1_1)-lg1.*cos(theta1_2).*sin(theta1_1))+lg3.*m3.*sin(theta3_1).*sin(theta3_2).*(l1.*sin(theta1_2)-lg1.*sin(theta1_2))+lg1.*lg3.*m3.*cos(theta1_2).*cos(theta3_2).*sin(theta1_1)+lg1.*lg3.*m3.*sin(theta1_2).*sin(theta3_1).*sin(theta3_2)];
mt12 = [-lg3.*m3.*sin(theta3_1).*sin(theta3_2).*(l2.*cos(theta2_1).*cos(theta2_2)-lg2.*cos(theta2_1).*cos(theta2_2))+lg3.*m3.*cos(theta3_1).*sin(theta3_2).*(l2.*cos(theta2_2).*sin(theta2_1)-lg2.*cos(theta2_2).*sin(theta2_1))-lg2.*lg3.*m3.*cos(theta2_1).*cos(theta2_2).*sin(theta3_1).*sin(theta3_2)+lg2.*lg3.*m3.*cos(theta2_2).*cos(theta3_1).*sin(theta2_1).*sin(theta3_2),lg3.*m3.*cos(theta3_2).*(l2.*cos(theta2_1).*cos(theta2_2)-lg2.*cos(theta2_1).*cos(theta2_2))+lg3.*m3.*cos(theta3_1).*sin(theta3_2).*(l2.*sin(theta2_2)-lg2.*sin(theta2_2))+lg2.*lg3.*m3.*cos(theta2_1).*cos(theta2_2).*cos(theta3_2)+lg2.*lg3.*m3.*cos(theta3_1).*sin(theta2_2).*sin(theta3_2),lg3.*m3.*cos(theta3_2).*(l2.*cos(theta2_2).*sin(theta2_1)-lg2.*cos(theta2_2).*sin(theta2_1))+lg3.*m3.*sin(theta3_1).*sin(theta3_2).*(l2.*sin(theta2_2)-lg2.*sin(theta2_2))+lg2.*lg3.*m3.*cos(theta2_2).*cos(theta3_2).*sin(theta2_1)+lg2.*lg3.*m3.*sin(theta2_2).*sin(theta3_1).*sin(theta3_2),et52+et53,et49+et50+et51];
mt13 = [et47+et48,0.0,0.0,0.0,0.0,0.0,0.0,et59+et60,et56+et57+et58,et54+et55];
I_hirashima = reshape([mt1,mt2,mt3,mt4,mt5,mt6,mt7,mt8,mt9,mt10,mt11,mt12,mt13],9,9);
