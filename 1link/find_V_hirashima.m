function V_hirashima = find_V_hirashima(I1x,I1y,I1z,lg1,m1,omega1_1,omega1_2,omega1_3,seg1_top_a_1,seg1_top_a_2,seg1_top_a_3,theta1_1,theta1_2,theta1_3)
%find_V_hirashima
%    V_hirashima = find_V_hirashima(I1x,I1y,I1z,LG1,M1,OMEGA1_1,OMEGA1_2,OMEGA1_3,SEG1_TOP_A_1,SEG1_TOP_A_2,SEG1_TOP_A_3,THETA1_1,THETA1_2,THETA1_3)

%    This function was generated by the Symbolic Math Toolbox version 9.0.
%    16-Jun-2022 12:02:54

et1 = ((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).^2+I1y.*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_2).^2.*sin(theta1_1).^2);
et2 = ((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))).*(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et3 = -(-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1));
et4 = -sin(theta1_2).*(omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0)+omega1_2.*cos(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_1.^2.*cos(theta1_1).*sin(theta1_3)+omega1_3.^2.*cos(theta1_1).*sin(theta1_3)+omega1_1.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_2.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_1.*omega1_3.*cos(theta1_3).*sin(theta1_1).*2.0-omega1_1.*omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3).*2.0+omega1_2.*omega1_3.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3).*2.0);
et5 = -cos(theta1_2).*sin(theta1_3).*(omega1_1.^2.*cos(theta1_1).*cos(theta1_3)+omega1_3.^2.*cos(theta1_1).*cos(theta1_3)-omega1_1.*omega1_3.*sin(theta1_1).*sin(theta1_3).*2.0-omega1_1.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)-omega1_2.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)-omega1_3.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_1.*omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2).*2.0+omega1_2.*omega1_3.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1).*2.0)-omega1_3.*cos(theta1_2).*cos(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+omega1_2.*cos(theta1_3).*sin(theta1_2).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et6 = omega1_3.*cos(theta1_2).*sin(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+omega1_2.*sin(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2));
et7 = ((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))).*(I1z.*sin(theta1_2).^2+I1x.*cos(theta1_2).^2.*cos(theta1_3).^2+I1y.*cos(theta1_2).^2.*sin(theta1_3).^2);
et8 = (-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et9 = ((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et10 = (sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).*(omega1_2.^2.*cos(theta1_2).*cos(theta1_3)+omega1_3.^2.*cos(theta1_2).*cos(theta1_3)-omega1_2.*omega1_3.*sin(theta1_2).*sin(theta1_3).*2.0)-(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_2.^2.*cos(theta1_2).*sin(theta1_3)+omega1_3.^2.*cos(theta1_2).*sin(theta1_3)+omega1_2.*omega1_3.*cos(theta1_3).*sin(theta1_2).*2.0)+(omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et11 = omega1_1.*omega1_2.*cos(theta1_2).^2.*sin(theta1_1)+omega1_2.^2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2).*2.0;
et12 = -(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(-omega1_1.^2.*sin(theta1_1).*sin(theta1_3)-omega1_3.^2.*sin(theta1_1).*sin(theta1_3)+omega1_1.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_3.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_1.*omega1_3.*cos(theta1_1).*cos(theta1_3).*2.0+omega1_1.*omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1).*2.0+omega1_2.*omega1_3.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*2.0-omega1_1.*omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3).*2.0);
et13 = -(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.^2.*cos(theta1_3).*sin(theta1_1)+omega1_3.^2.*cos(theta1_3).*sin(theta1_1)+omega1_1.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_3.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_1.*omega1_3.*cos(theta1_1).*sin(theta1_3).*2.0-omega1_2.*omega1_3.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*2.0+omega1_1.*omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2).*2.0)+(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et14 = cos(theta1_2).*sin(theta1_1).*(omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+omega1_2.^2.*cos(theta1_1).*cos(theta1_2)-omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0)-omega1_2.*sin(theta1_1).*sin(theta1_2).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))+omega1_1.*cos(theta1_1).*cos(theta1_2).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2));
et15 = (et1+et2+et3).*((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2)))+(I1x.*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).^2+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_1).^2.*cos(theta1_2).^2).*(et4+et5+et6);
et16 = -((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(et7+et8+et9)+(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1)).*(et10+et11);
et17 = -(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))).*(et12+et13+et14)-lg1.*m1.*sin(theta1_2).*(-conj(seg1_top_a_2)+lg1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+lg1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+lg1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0)+lg1.*m1.*cos(theta1_2).*sin(theta1_1).*(conj(seg1_top_a_1)+lg1.*omega1_2.^2.*sin(theta1_2));
et18 = -sin(theta1_2).*(omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0)+omega1_2.*cos(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_1.^2.*cos(theta1_1).*sin(theta1_3)+omega1_3.^2.*cos(theta1_1).*sin(theta1_3)+omega1_1.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_2.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_1.*omega1_3.*cos(theta1_3).*sin(theta1_1).*2.0-omega1_1.*omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3).*2.0+omega1_2.*omega1_3.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3).*2.0);
et19 = -cos(theta1_2).*sin(theta1_3).*(omega1_1.^2.*cos(theta1_1).*cos(theta1_3)+omega1_3.^2.*cos(theta1_1).*cos(theta1_3)-omega1_1.*omega1_3.*sin(theta1_1).*sin(theta1_3).*2.0-omega1_1.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)-omega1_2.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)-omega1_3.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_1.*omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2).*2.0+omega1_2.*omega1_3.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1).*2.0)-omega1_3.*cos(theta1_2).*cos(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+omega1_2.*cos(theta1_3).*sin(theta1_2).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et20 = omega1_3.*cos(theta1_2).*sin(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+omega1_2.*sin(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2));
et21 = ((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))).*(I1z.*sin(theta1_2).^2+I1x.*cos(theta1_2).^2.*cos(theta1_3).^2+I1y.*cos(theta1_2).^2.*sin(theta1_3).^2);
et22 = (-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et23 = ((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et24 = ((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))).*(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et25 = -((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1));
et26 = (-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1x.*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).^2+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_1).^2.*cos(theta1_2).^2);
et27 = -(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(-omega1_1.^2.*sin(theta1_1).*sin(theta1_3)-omega1_3.^2.*sin(theta1_1).*sin(theta1_3)+omega1_1.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_3.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_1.*omega1_3.*cos(theta1_1).*cos(theta1_3).*2.0+omega1_1.*omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1).*2.0+omega1_2.*omega1_3.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*2.0-omega1_1.*omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3).*2.0);
et28 = -(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.^2.*cos(theta1_3).*sin(theta1_1)+omega1_3.^2.*cos(theta1_3).*sin(theta1_1)+omega1_1.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_3.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_1.*omega1_3.*cos(theta1_1).*sin(theta1_3).*2.0-omega1_2.*omega1_3.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*2.0+omega1_1.*omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2).*2.0)+(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et29 = cos(theta1_2).*sin(theta1_1).*(omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+omega1_2.^2.*cos(theta1_1).*cos(theta1_2)-omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0)-omega1_2.*sin(theta1_1).*sin(theta1_2).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))+omega1_1.*cos(theta1_1).*cos(theta1_2).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2));
et30 = (sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).*(omega1_2.^2.*cos(theta1_2).*cos(theta1_3)+omega1_3.^2.*cos(theta1_2).*cos(theta1_3)-omega1_2.*omega1_3.*sin(theta1_2).*sin(theta1_3).*2.0)-(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_2.^2.*cos(theta1_2).*sin(theta1_3)+omega1_3.^2.*cos(theta1_2).*sin(theta1_3)+omega1_2.*omega1_3.*cos(theta1_3).*sin(theta1_2).*2.0)+(omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et31 = omega1_1.*omega1_2.*cos(theta1_2).^2.*sin(theta1_1)+omega1_2.^2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2).*2.0;
et32 = (I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1)).*(et18+et19+et20)-(-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(et21+et22+et23);
et33 = (et24+et25+et26).*((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2)))+(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))).*(et27+et28+et29);
et34 = (I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).^2+I1y.*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_2).^2.*sin(theta1_1).^2).*(et30+et31)-lg1.*m1.*sin(theta1_2).*(conj(seg1_top_a_3)+lg1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+lg1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)-lg1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0)+lg1.*m1.*cos(theta1_1).*cos(theta1_2).*(conj(seg1_top_a_1)+lg1.*omega1_2.^2.*sin(theta1_2));
et35 = -sin(theta1_2).*(omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0)+omega1_2.*cos(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_1.^2.*cos(theta1_1).*sin(theta1_3)+omega1_3.^2.*cos(theta1_1).*sin(theta1_3)+omega1_1.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_2.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_1.*omega1_3.*cos(theta1_3).*sin(theta1_1).*2.0-omega1_1.*omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3).*2.0+omega1_2.*omega1_3.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3).*2.0);
et36 = -cos(theta1_2).*sin(theta1_3).*(omega1_1.^2.*cos(theta1_1).*cos(theta1_3)+omega1_3.^2.*cos(theta1_1).*cos(theta1_3)-omega1_1.*omega1_3.*sin(theta1_1).*sin(theta1_3).*2.0-omega1_1.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)-omega1_2.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)-omega1_3.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_1.*omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2).*2.0+omega1_2.*omega1_3.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1).*2.0)-omega1_3.*cos(theta1_2).*cos(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+omega1_2.*cos(theta1_3).*sin(theta1_2).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et37 = omega1_3.*cos(theta1_2).*sin(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+omega1_2.*sin(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2));
et38 = ((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))).*(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et39 = -((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1));
et40 = (-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1x.*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).^2+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_1).^2.*cos(theta1_2).^2);
et41 = ((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).^2+I1y.*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_2).^2.*sin(theta1_1).^2);
et42 = ((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))).*(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et43 = -(-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1));
et44 = (sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).*(omega1_2.^2.*cos(theta1_2).*cos(theta1_3)+omega1_3.^2.*cos(theta1_2).*cos(theta1_3)-omega1_2.*omega1_3.*sin(theta1_2).*sin(theta1_3).*2.0)-(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_2.^2.*cos(theta1_2).*sin(theta1_3)+omega1_3.^2.*cos(theta1_2).*sin(theta1_3)+omega1_2.*omega1_3.*cos(theta1_3).*sin(theta1_2).*2.0)+(omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et45 = omega1_1.*omega1_2.*cos(theta1_2).^2.*sin(theta1_1)+omega1_2.^2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2).*2.0;
et46 = -(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(-omega1_1.^2.*sin(theta1_1).*sin(theta1_3)-omega1_3.^2.*sin(theta1_1).*sin(theta1_3)+omega1_1.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_3.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_1.*omega1_3.*cos(theta1_1).*cos(theta1_3).*2.0+omega1_1.*omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1).*2.0+omega1_2.*omega1_3.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*2.0-omega1_1.*omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3).*2.0);
et47 = -(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.^2.*cos(theta1_3).*sin(theta1_1)+omega1_3.^2.*cos(theta1_3).*sin(theta1_1)+omega1_1.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_3.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_1.*omega1_3.*cos(theta1_1).*sin(theta1_3).*2.0-omega1_2.*omega1_3.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*2.0+omega1_1.*omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2).*2.0)+(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et48 = cos(theta1_2).*sin(theta1_1).*(omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+omega1_2.^2.*cos(theta1_1).*cos(theta1_2)-omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0)-omega1_2.*sin(theta1_1).*sin(theta1_2).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))+omega1_1.*cos(theta1_1).*cos(theta1_2).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2));
et49 = (I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))).*(et35+et36+et37)+((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(et38+et39+et40);
et50 = -(-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(et41+et42+et43)-(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))).*(et44+et45);
et51 = -(I1z.*sin(theta1_2).^2+I1x.*cos(theta1_2).^2.*cos(theta1_3).^2+I1y.*cos(theta1_2).^2.*sin(theta1_3).^2).*(et46+et47+et48)-lg1.*m1.*cos(theta1_2).*sin(theta1_1).*(conj(seg1_top_a_3)+lg1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+lg1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)-lg1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0)+lg1.*m1.*cos(theta1_1).*cos(theta1_2).*(-conj(seg1_top_a_2)+lg1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+lg1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+lg1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0);
V_hirashima = [et49+et50+et51;et32+et33+et34;et15+et16+et17];
