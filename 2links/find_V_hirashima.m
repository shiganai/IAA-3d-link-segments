function V_hirashima = find_V_hirashima(I1x,I2x,I1y,I2y,I1z,I2z,l1,lg1,lg2,m1,m2,omega1_1,omega1_2,omega1_3,omega2_1,omega2_2,omega2_3,seg1_top_a_1,seg1_top_a_2,seg1_top_a_3,theta1_1,theta1_2,theta1_3,theta2_1,theta2_2,theta2_3)
%find_V_hirashima
%    V_hirashima = find_V_hirashima(I1x,I2x,I1y,I2y,I1z,I2z,L1,LG1,LG2,M1,M2,OMEGA1_1,OMEGA1_2,OMEGA1_3,OMEGA2_1,OMEGA2_2,OMEGA2_3,SEG1_TOP_A_1,SEG1_TOP_A_2,SEG1_TOP_A_3,THETA1_1,THETA1_2,THETA1_3,THETA2_1,THETA2_2,THETA2_3)

%    This function was generated by the Symbolic Math Toolbox version 9.0.
%    16-Jun-2022 12:22:24

et1 = ((omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))-omega2_2.*cos(theta2_1).*cos(theta2_2).^2).*(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).^2+I2y.*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).^2+I2z.*cos(theta2_2).^2.*sin(theta2_1).^2);
et2 = ((cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_1).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2))).*(I2z.*cos(theta2_2).*sin(theta2_1).*sin(theta2_2)-I2x.*cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et3 = -(-sin(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))).*(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))-I2z.*cos(theta2_1).*cos(theta2_2).^2.*sin(theta2_1));
et4 = -sin(theta2_2).*(omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0)+omega2_2.*cos(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_1.^2.*cos(theta2_1).*sin(theta2_3)+omega2_3.^2.*cos(theta2_1).*sin(theta2_3)+omega2_1.^2.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_2.^2.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.^2.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_1.*omega2_3.*cos(theta2_3).*sin(theta2_1).*2.0-omega2_1.*omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3).*2.0+omega2_1.*omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3).*2.0+omega2_2.*omega2_3.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3).*2.0);
et5 = -cos(theta2_2).*sin(theta2_3).*(omega2_1.^2.*cos(theta2_1).*cos(theta2_3)+omega2_3.^2.*cos(theta2_1).*cos(theta2_3)-omega2_1.*omega2_3.*sin(theta2_1).*sin(theta2_3).*2.0-omega2_1.^2.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)-omega2_2.^2.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)-omega2_3.^2.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_1.*omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3).*2.0+omega2_1.*omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2).*2.0+omega2_2.*omega2_3.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1).*2.0)-omega2_3.*cos(theta2_2).*cos(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+omega2_2.*cos(theta2_3).*sin(theta2_2).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3));
et6 = omega2_3.*cos(theta2_2).*sin(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+omega2_2.*sin(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2));
et7 = ((cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_1).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2))).*(I2z.*sin(theta2_2).^2+I2x.*cos(theta2_2).^2.*cos(theta2_3).^2+I2y.*cos(theta2_2).^2.*sin(theta2_3).^2);
et8 = (-sin(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))).*(I2z.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2)+I2x.*cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et9 = ((omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))-omega2_2.*cos(theta2_1).*cos(theta2_2).^2).*(I2z.*cos(theta2_2).*sin(theta2_1).*sin(theta2_2)-I2x.*cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et10 = (sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2)).*(omega2_2.^2.*cos(theta2_2).*cos(theta2_3)+omega2_3.^2.*cos(theta2_2).*cos(theta2_3)-omega2_2.*omega2_3.*sin(theta2_2).*sin(theta2_3).*2.0)-(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_2.^2.*cos(theta2_2).*sin(theta2_3)+omega2_3.^2.*cos(theta2_2).*sin(theta2_3)+omega2_2.*omega2_3.*cos(theta2_3).*sin(theta2_2).*2.0)+(omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3));
et11 = omega2_1.*omega2_2.*cos(theta2_2).^2.*sin(theta2_1)+omega2_2.^2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2).*2.0;
et12 = -(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(-omega2_1.^2.*sin(theta2_1).*sin(theta2_3)-omega2_3.^2.*sin(theta2_1).*sin(theta2_3)+omega2_1.^2.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.^2.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_3.^2.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_1.*omega2_3.*cos(theta2_1).*cos(theta2_3).*2.0+omega2_1.*omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1).*2.0+omega2_2.*omega2_3.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3).*2.0-omega2_1.*omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3).*2.0);
et13 = -(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.^2.*cos(theta2_3).*sin(theta2_1)+omega2_3.^2.*cos(theta2_3).*sin(theta2_1)+omega2_1.^2.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.^2.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_3.^2.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_1.*omega2_3.*cos(theta2_1).*sin(theta2_3).*2.0-omega2_2.*omega2_3.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3).*2.0+omega2_1.*omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3).*2.0+omega2_1.*omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2).*2.0)+(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3));
et14 = cos(theta2_2).*sin(theta2_1).*(omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+omega2_2.^2.*cos(theta2_1).*cos(theta2_2)-omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0)-omega2_2.*sin(theta2_1).*sin(theta2_2).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2))+omega2_1.*cos(theta2_1).*cos(theta2_2).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2));
et15 = (et1+et2+et3).*((cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_1).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2)))+(I2x.*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2)).^2+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).^2+I2z.*cos(theta2_1).^2.*cos(theta2_2).^2).*(et4+et5+et6);
et16 = -((omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))-omega2_2.*cos(theta2_1).*cos(theta2_2).^2).*(et7+et8+et9)+(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))-I2z.*cos(theta2_1).*cos(theta2_2).^2.*sin(theta2_1)).*(et10+et11);
et17 = -(I2z.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2)+I2x.*cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))).*(et12+et13+et14)-lg2.*m2.*sin(theta2_2).*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+lg2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+lg2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+lg2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0)+lg2.*m2.*cos(theta2_2).*sin(theta2_1).*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+lg2.*omega2_2.^2.*sin(theta2_2));
et18 = -sin(theta2_2).*(omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0)+omega2_2.*cos(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_1.^2.*cos(theta2_1).*sin(theta2_3)+omega2_3.^2.*cos(theta2_1).*sin(theta2_3)+omega2_1.^2.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_2.^2.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.^2.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_1.*omega2_3.*cos(theta2_3).*sin(theta2_1).*2.0-omega2_1.*omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3).*2.0+omega2_1.*omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3).*2.0+omega2_2.*omega2_3.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3).*2.0);
et19 = -cos(theta2_2).*sin(theta2_3).*(omega2_1.^2.*cos(theta2_1).*cos(theta2_3)+omega2_3.^2.*cos(theta2_1).*cos(theta2_3)-omega2_1.*omega2_3.*sin(theta2_1).*sin(theta2_3).*2.0-omega2_1.^2.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)-omega2_2.^2.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)-omega2_3.^2.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_1.*omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3).*2.0+omega2_1.*omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2).*2.0+omega2_2.*omega2_3.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1).*2.0)-omega2_3.*cos(theta2_2).*cos(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+omega2_2.*cos(theta2_3).*sin(theta2_2).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3));
et20 = omega2_3.*cos(theta2_2).*sin(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+omega2_2.*sin(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2));
et21 = ((cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_1).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2))).*(I2z.*sin(theta2_2).^2+I2x.*cos(theta2_2).^2.*cos(theta2_3).^2+I2y.*cos(theta2_2).^2.*sin(theta2_3).^2);
et22 = (-sin(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))).*(I2z.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2)+I2x.*cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et23 = ((omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))-omega2_2.*cos(theta2_1).*cos(theta2_2).^2).*(I2z.*cos(theta2_2).*sin(theta2_1).*sin(theta2_2)-I2x.*cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et24 = ((cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_1).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2))).*(I2z.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2)+I2x.*cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et25 = -((omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))-omega2_2.*cos(theta2_1).*cos(theta2_2).^2).*(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))-I2z.*cos(theta2_1).*cos(theta2_2).^2.*sin(theta2_1));
et26 = (-sin(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))).*(I2x.*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2)).^2+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).^2+I2z.*cos(theta2_1).^2.*cos(theta2_2).^2);
et27 = -(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(-omega2_1.^2.*sin(theta2_1).*sin(theta2_3)-omega2_3.^2.*sin(theta2_1).*sin(theta2_3)+omega2_1.^2.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.^2.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_3.^2.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_1.*omega2_3.*cos(theta2_1).*cos(theta2_3).*2.0+omega2_1.*omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1).*2.0+omega2_2.*omega2_3.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3).*2.0-omega2_1.*omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3).*2.0);
et28 = -(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.^2.*cos(theta2_3).*sin(theta2_1)+omega2_3.^2.*cos(theta2_3).*sin(theta2_1)+omega2_1.^2.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.^2.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_3.^2.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_1.*omega2_3.*cos(theta2_1).*sin(theta2_3).*2.0-omega2_2.*omega2_3.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3).*2.0+omega2_1.*omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3).*2.0+omega2_1.*omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2).*2.0)+(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3));
et29 = cos(theta2_2).*sin(theta2_1).*(omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+omega2_2.^2.*cos(theta2_1).*cos(theta2_2)-omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0)-omega2_2.*sin(theta2_1).*sin(theta2_2).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2))+omega2_1.*cos(theta2_1).*cos(theta2_2).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2));
et30 = (sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2)).*(omega2_2.^2.*cos(theta2_2).*cos(theta2_3)+omega2_3.^2.*cos(theta2_2).*cos(theta2_3)-omega2_2.*omega2_3.*sin(theta2_2).*sin(theta2_3).*2.0)-(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_2.^2.*cos(theta2_2).*sin(theta2_3)+omega2_3.^2.*cos(theta2_2).*sin(theta2_3)+omega2_2.*omega2_3.*cos(theta2_3).*sin(theta2_2).*2.0)+(omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3));
et31 = omega2_1.*omega2_2.*cos(theta2_2).^2.*sin(theta2_1)+omega2_2.^2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2).*2.0;
et32 = (I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))-I2z.*cos(theta2_1).*cos(theta2_2).^2.*sin(theta2_1)).*(et18+et19+et20)-(-sin(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))).*(et21+et22+et23);
et33 = (et24+et25+et26).*((cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_1).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2)))+(I2z.*cos(theta2_2).*sin(theta2_1).*sin(theta2_2)-I2x.*cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))).*(et27+et28+et29);
et34 = (I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).^2+I2y.*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).^2+I2z.*cos(theta2_2).^2.*sin(theta2_1).^2).*(et30+et31)-lg2.*m2.*sin(theta2_2).*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+lg2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+lg2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-lg2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0)+lg2.*m2.*cos(theta2_1).*cos(theta2_2).*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+lg2.*omega2_2.^2.*sin(theta2_2));
et35 = -sin(theta2_2).*(omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0)+omega2_2.*cos(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_1.^2.*cos(theta2_1).*sin(theta2_3)+omega2_3.^2.*cos(theta2_1).*sin(theta2_3)+omega2_1.^2.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_2.^2.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.^2.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_1.*omega2_3.*cos(theta2_3).*sin(theta2_1).*2.0-omega2_1.*omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3).*2.0+omega2_1.*omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3).*2.0+omega2_2.*omega2_3.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3).*2.0);
et36 = -cos(theta2_2).*sin(theta2_3).*(omega2_1.^2.*cos(theta2_1).*cos(theta2_3)+omega2_3.^2.*cos(theta2_1).*cos(theta2_3)-omega2_1.*omega2_3.*sin(theta2_1).*sin(theta2_3).*2.0-omega2_1.^2.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)-omega2_2.^2.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)-omega2_3.^2.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_1.*omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3).*2.0+omega2_1.*omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2).*2.0+omega2_2.*omega2_3.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1).*2.0)-omega2_3.*cos(theta2_2).*cos(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+omega2_2.*cos(theta2_3).*sin(theta2_2).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3));
et37 = omega2_3.*cos(theta2_2).*sin(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+omega2_2.*sin(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2));
et38 = ((cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_1).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2))).*(I2z.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2)+I2x.*cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et39 = -((omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))-omega2_2.*cos(theta2_1).*cos(theta2_2).^2).*(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))-I2z.*cos(theta2_1).*cos(theta2_2).^2.*sin(theta2_1));
et40 = (-sin(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))).*(I2x.*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2)).^2+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).^2+I2z.*cos(theta2_1).^2.*cos(theta2_2).^2);
et41 = ((omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))-omega2_2.*cos(theta2_1).*cos(theta2_2).^2).*(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).^2+I2y.*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).^2+I2z.*cos(theta2_2).^2.*sin(theta2_1).^2);
et42 = ((cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_1).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2))).*(I2z.*cos(theta2_2).*sin(theta2_1).*sin(theta2_2)-I2x.*cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)));
et43 = -(-sin(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))).*(I2x.*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+I2y.*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))-I2z.*cos(theta2_1).*cos(theta2_2).^2.*sin(theta2_1));
et44 = (sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2)).*(omega2_2.^2.*cos(theta2_2).*cos(theta2_3)+omega2_3.^2.*cos(theta2_2).*cos(theta2_3)-omega2_2.*omega2_3.*sin(theta2_2).*sin(theta2_3).*2.0)-(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_2.^2.*cos(theta2_2).*sin(theta2_3)+omega2_3.^2.*cos(theta2_2).*sin(theta2_3)+omega2_2.*omega2_3.*cos(theta2_3).*sin(theta2_2).*2.0)+(omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3));
et45 = omega2_1.*omega2_2.*cos(theta2_2).^2.*sin(theta2_1)+omega2_2.^2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2).*2.0;
et46 = -(omega2_1.*cos(theta2_1).*cos(theta2_3)-omega2_3.*sin(theta2_1).*sin(theta2_3)+omega2_2.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3)+omega2_3.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)-omega2_1.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2)).*(-omega2_1.^2.*sin(theta2_1).*sin(theta2_3)-omega2_3.^2.*sin(theta2_1).*sin(theta2_3)+omega2_1.^2.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.^2.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_3.^2.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_1.*omega2_3.*cos(theta2_1).*cos(theta2_3).*2.0+omega2_1.*omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1).*2.0+omega2_2.*omega2_3.*cos(theta2_1).*cos(theta2_2).*sin(theta2_3).*2.0-omega2_1.*omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3).*2.0);
et47 = -(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_1.^2.*cos(theta2_3).*sin(theta2_1)+omega2_3.^2.*cos(theta2_3).*sin(theta2_1)+omega2_1.^2.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.^2.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_3.^2.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_1.*omega2_3.*cos(theta2_1).*sin(theta2_3).*2.0-omega2_2.*omega2_3.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3).*2.0+omega2_1.*omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3).*2.0+omega2_1.*omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2).*2.0)+(omega2_1.*cos(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1)-omega2_2.*cos(theta2_1).*cos(theta2_2).*cos(theta2_3)+omega2_1.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2)+omega2_3.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3));
et48 = cos(theta2_2).*sin(theta2_1).*(omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+omega2_2.^2.*cos(theta2_1).*cos(theta2_2)-omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0)-omega2_2.*sin(theta2_1).*sin(theta2_2).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2))+omega2_1.*cos(theta2_1).*cos(theta2_2).*(omega2_1.*cos(theta2_2).*sin(theta2_1)+omega2_2.*cos(theta2_1).*sin(theta2_2));
et49 = (I2z.*cos(theta2_1).*cos(theta2_2).*sin(theta2_2)+I2x.*cos(theta2_2).*cos(theta2_3).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))-I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))).*(et35+et36+et37)+((omega2_2.*cos(theta2_3).*sin(theta2_2)+omega2_3.*cos(theta2_2).*sin(theta2_3)).*(sin(theta2_1).*sin(theta2_3)-cos(theta2_1).*cos(theta2_3).*sin(theta2_2))+(omega2_3.*cos(theta2_2).*cos(theta2_3)-omega2_2.*sin(theta2_2).*sin(theta2_3)).*(cos(theta2_3).*sin(theta2_1)+cos(theta2_1).*sin(theta2_2).*sin(theta2_3))-omega2_2.*cos(theta2_1).*cos(theta2_2).^2).*(et38+et39+et40);
et50 = -(-sin(theta2_2).*(omega2_1.*cos(theta2_1).*cos(theta2_2)-omega2_2.*sin(theta2_1).*sin(theta2_2))+cos(theta2_2).*cos(theta2_3).*(omega2_3.*cos(theta2_1).*cos(theta2_3)-omega2_1.*sin(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*cos(theta2_3).*sin(theta2_2)+omega2_2.*cos(theta2_2).*cos(theta2_3).*sin(theta2_1)-omega2_3.*sin(theta2_1).*sin(theta2_2).*sin(theta2_3))+cos(theta2_2).*sin(theta2_3).*(omega2_1.*cos(theta2_3).*sin(theta2_1)+omega2_3.*cos(theta2_1).*sin(theta2_3)+omega2_1.*cos(theta2_1).*sin(theta2_2).*sin(theta2_3)+omega2_2.*cos(theta2_2).*sin(theta2_1).*sin(theta2_3)+omega2_3.*cos(theta2_3).*sin(theta2_1).*sin(theta2_2))).*(et41+et42+et43)-(I2z.*cos(theta2_2).*sin(theta2_1).*sin(theta2_2)-I2x.*cos(theta2_2).*cos(theta2_3).*(cos(theta2_1).*sin(theta2_3)+cos(theta2_3).*sin(theta2_1).*sin(theta2_2))+I2y.*cos(theta2_2).*sin(theta2_3).*(cos(theta2_1).*cos(theta2_3)-sin(theta2_1).*sin(theta2_2).*sin(theta2_3))).*(et44+et45);
et51 = -(I2z.*sin(theta2_2).^2+I2x.*cos(theta2_2).^2.*cos(theta2_3).^2+I2y.*cos(theta2_2).^2.*sin(theta2_3).^2).*(et46+et47+et48)-lg2.*m2.*cos(theta2_2).*sin(theta2_1).*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+lg2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+lg2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-lg2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0)+lg2.*m2.*cos(theta2_1).*cos(theta2_2).*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+lg2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+lg2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+lg2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0);
et52 = ((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).^2+I1y.*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_2).^2.*sin(theta1_1).^2);
et53 = ((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))).*(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et54 = -(-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1));
et55 = -sin(theta1_2).*(omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0)+omega1_2.*cos(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_1.^2.*cos(theta1_1).*sin(theta1_3)+omega1_3.^2.*cos(theta1_1).*sin(theta1_3)+omega1_1.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_2.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_1.*omega1_3.*cos(theta1_3).*sin(theta1_1).*2.0-omega1_1.*omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3).*2.0+omega1_2.*omega1_3.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3).*2.0);
et56 = -cos(theta1_2).*sin(theta1_3).*(omega1_1.^2.*cos(theta1_1).*cos(theta1_3)+omega1_3.^2.*cos(theta1_1).*cos(theta1_3)-omega1_1.*omega1_3.*sin(theta1_1).*sin(theta1_3).*2.0-omega1_1.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)-omega1_2.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)-omega1_3.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_1.*omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2).*2.0+omega1_2.*omega1_3.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1).*2.0)-omega1_3.*cos(theta1_2).*cos(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+omega1_2.*cos(theta1_3).*sin(theta1_2).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et57 = omega1_3.*cos(theta1_2).*sin(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+omega1_2.*sin(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2));
et58 = ((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))).*(I1z.*sin(theta1_2).^2+I1x.*cos(theta1_2).^2.*cos(theta1_3).^2+I1y.*cos(theta1_2).^2.*sin(theta1_3).^2);
et59 = (-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et60 = ((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et61 = (sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).*(omega1_2.^2.*cos(theta1_2).*cos(theta1_3)+omega1_3.^2.*cos(theta1_2).*cos(theta1_3)-omega1_2.*omega1_3.*sin(theta1_2).*sin(theta1_3).*2.0)-(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_2.^2.*cos(theta1_2).*sin(theta1_3)+omega1_3.^2.*cos(theta1_2).*sin(theta1_3)+omega1_2.*omega1_3.*cos(theta1_3).*sin(theta1_2).*2.0)+(omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et62 = omega1_1.*omega1_2.*cos(theta1_2).^2.*sin(theta1_1)+omega1_2.^2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2).*2.0;
et63 = -(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(-omega1_1.^2.*sin(theta1_1).*sin(theta1_3)-omega1_3.^2.*sin(theta1_1).*sin(theta1_3)+omega1_1.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_3.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_1.*omega1_3.*cos(theta1_1).*cos(theta1_3).*2.0+omega1_1.*omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1).*2.0+omega1_2.*omega1_3.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*2.0-omega1_1.*omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3).*2.0);
et64 = -(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.^2.*cos(theta1_3).*sin(theta1_1)+omega1_3.^2.*cos(theta1_3).*sin(theta1_1)+omega1_1.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_3.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_1.*omega1_3.*cos(theta1_1).*sin(theta1_3).*2.0-omega1_2.*omega1_3.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*2.0+omega1_1.*omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2).*2.0)+(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et65 = cos(theta1_2).*sin(theta1_1).*(omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+omega1_2.^2.*cos(theta1_1).*cos(theta1_2)-omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0)-omega1_2.*sin(theta1_1).*sin(theta1_2).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))+omega1_1.*cos(theta1_1).*cos(theta1_2).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2));
et66 = (et52+et53+et54).*((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2)))+(I1x.*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).^2+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_1).^2.*cos(theta1_2).^2).*(et55+et56+et57);
et67 = -((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(et58+et59+et60)+(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1)).*(et61+et62);
et68 = -(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))).*(et63+et64+et65)-lg1.*sin(theta1_2).*(m1.*(-conj(seg1_top_a_2)+lg1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+lg1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+lg1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0)+m2.*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+lg2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+lg2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+lg2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0));
et69 = -m2.*(l1.*sin(theta1_2)-lg1.*sin(theta1_2)).*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+lg2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+lg2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+lg2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0)+m2.*(l1.*cos(theta1_2).*sin(theta1_1)-lg1.*cos(theta1_2).*sin(theta1_1)).*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+lg2.*omega2_2.^2.*sin(theta2_2))+lg1.*cos(theta1_2).*sin(theta1_1).*(m2.*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+lg2.*omega2_2.^2.*sin(theta2_2))+m1.*(conj(seg1_top_a_1)+lg1.*omega1_2.^2.*sin(theta1_2)));
et70 = -sin(theta1_2).*(omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0)+omega1_2.*cos(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_1.^2.*cos(theta1_1).*sin(theta1_3)+omega1_3.^2.*cos(theta1_1).*sin(theta1_3)+omega1_1.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_2.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_1.*omega1_3.*cos(theta1_3).*sin(theta1_1).*2.0-omega1_1.*omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3).*2.0+omega1_2.*omega1_3.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3).*2.0);
et71 = -cos(theta1_2).*sin(theta1_3).*(omega1_1.^2.*cos(theta1_1).*cos(theta1_3)+omega1_3.^2.*cos(theta1_1).*cos(theta1_3)-omega1_1.*omega1_3.*sin(theta1_1).*sin(theta1_3).*2.0-omega1_1.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)-omega1_2.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)-omega1_3.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_1.*omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2).*2.0+omega1_2.*omega1_3.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1).*2.0)-omega1_3.*cos(theta1_2).*cos(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+omega1_2.*cos(theta1_3).*sin(theta1_2).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et72 = omega1_3.*cos(theta1_2).*sin(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+omega1_2.*sin(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2));
et73 = ((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))).*(I1z.*sin(theta1_2).^2+I1x.*cos(theta1_2).^2.*cos(theta1_3).^2+I1y.*cos(theta1_2).^2.*sin(theta1_3).^2);
et74 = (-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et75 = ((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et76 = ((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))).*(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et77 = -((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1));
et78 = (-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1x.*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).^2+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_1).^2.*cos(theta1_2).^2);
et79 = -(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(-omega1_1.^2.*sin(theta1_1).*sin(theta1_3)-omega1_3.^2.*sin(theta1_1).*sin(theta1_3)+omega1_1.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_3.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_1.*omega1_3.*cos(theta1_1).*cos(theta1_3).*2.0+omega1_1.*omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1).*2.0+omega1_2.*omega1_3.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*2.0-omega1_1.*omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3).*2.0);
et80 = -(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.^2.*cos(theta1_3).*sin(theta1_1)+omega1_3.^2.*cos(theta1_3).*sin(theta1_1)+omega1_1.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_3.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_1.*omega1_3.*cos(theta1_1).*sin(theta1_3).*2.0-omega1_2.*omega1_3.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*2.0+omega1_1.*omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2).*2.0)+(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et81 = cos(theta1_2).*sin(theta1_1).*(omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+omega1_2.^2.*cos(theta1_1).*cos(theta1_2)-omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0)-omega1_2.*sin(theta1_1).*sin(theta1_2).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))+omega1_1.*cos(theta1_1).*cos(theta1_2).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2));
et82 = (sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).*(omega1_2.^2.*cos(theta1_2).*cos(theta1_3)+omega1_3.^2.*cos(theta1_2).*cos(theta1_3)-omega1_2.*omega1_3.*sin(theta1_2).*sin(theta1_3).*2.0)-(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_2.^2.*cos(theta1_2).*sin(theta1_3)+omega1_3.^2.*cos(theta1_2).*sin(theta1_3)+omega1_2.*omega1_3.*cos(theta1_3).*sin(theta1_2).*2.0)+(omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et83 = omega1_1.*omega1_2.*cos(theta1_2).^2.*sin(theta1_1)+omega1_2.^2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2).*2.0;
et84 = (I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1)).*(et70+et71+et72)-(-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(et73+et74+et75);
et85 = (et76+et77+et78).*((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2)))+(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))).*(et79+et80+et81);
et86 = (I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).^2+I1y.*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_2).^2.*sin(theta1_1).^2).*(et82+et83)-lg1.*sin(theta1_2).*(m1.*(conj(seg1_top_a_3)+lg1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+lg1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)-lg1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0)+m2.*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+lg2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+lg2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-lg2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0))+m2.*(l1.*cos(theta1_1).*cos(theta1_2)-lg1.*cos(theta1_1).*cos(theta1_2)).*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+lg2.*omega2_2.^2.*sin(theta2_2));
et87 = -m2.*(l1.*sin(theta1_2)-lg1.*sin(theta1_2)).*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+lg2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+lg2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-lg2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0)+lg1.*cos(theta1_1).*cos(theta1_2).*(m2.*(conj(seg1_top_a_1)+l1.*omega1_2.^2.*sin(theta1_2)+lg2.*omega2_2.^2.*sin(theta2_2))+m1.*(conj(seg1_top_a_1)+lg1.*omega1_2.^2.*sin(theta1_2)));
et88 = -sin(theta1_2).*(omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0)+omega1_2.*cos(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_1.^2.*cos(theta1_1).*sin(theta1_3)+omega1_3.^2.*cos(theta1_1).*sin(theta1_3)+omega1_1.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_2.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.^2.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_1.*omega1_3.*cos(theta1_3).*sin(theta1_1).*2.0-omega1_1.*omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3).*2.0+omega1_2.*omega1_3.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3).*2.0);
et89 = -cos(theta1_2).*sin(theta1_3).*(omega1_1.^2.*cos(theta1_1).*cos(theta1_3)+omega1_3.^2.*cos(theta1_1).*cos(theta1_3)-omega1_1.*omega1_3.*sin(theta1_1).*sin(theta1_3).*2.0-omega1_1.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)-omega1_2.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)-omega1_3.^2.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_1.*omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2).*2.0+omega1_2.*omega1_3.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1).*2.0)-omega1_3.*cos(theta1_2).*cos(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+omega1_2.*cos(theta1_3).*sin(theta1_2).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et90 = omega1_3.*cos(theta1_2).*sin(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+omega1_2.*sin(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2));
et91 = ((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))).*(I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et92 = -((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1));
et93 = (-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1x.*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).^2+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_1).^2.*cos(theta1_2).^2);
et94 = ((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).^2+I1y.*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).^2+I1z.*cos(theta1_2).^2.*sin(theta1_1).^2);
et95 = ((cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_1).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))).*(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)));
et96 = -(-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(I1x.*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+I1y.*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))-I1z.*cos(theta1_1).*cos(theta1_2).^2.*sin(theta1_1));
et97 = (sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2)).*(omega1_2.^2.*cos(theta1_2).*cos(theta1_3)+omega1_3.^2.*cos(theta1_2).*cos(theta1_3)-omega1_2.*omega1_3.*sin(theta1_2).*sin(theta1_3).*2.0)-(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_2.^2.*cos(theta1_2).*sin(theta1_3)+omega1_3.^2.*cos(theta1_2).*sin(theta1_3)+omega1_2.*omega1_3.*cos(theta1_3).*sin(theta1_2).*2.0)+(omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et98 = omega1_1.*omega1_2.*cos(theta1_2).^2.*sin(theta1_1)+omega1_2.^2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2).*2.0;
et99 = -(omega1_1.*cos(theta1_1).*cos(theta1_3)-omega1_3.*sin(theta1_1).*sin(theta1_3)+omega1_2.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3)+omega1_3.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)-omega1_1.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2)).*(-omega1_1.^2.*sin(theta1_1).*sin(theta1_3)-omega1_3.^2.*sin(theta1_1).*sin(theta1_3)+omega1_1.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_3.^2.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_1.*omega1_3.*cos(theta1_1).*cos(theta1_3).*2.0+omega1_1.*omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1).*2.0+omega1_2.*omega1_3.*cos(theta1_1).*cos(theta1_2).*sin(theta1_3).*2.0-omega1_1.*omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3).*2.0);
et100 = -(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_1.^2.*cos(theta1_3).*sin(theta1_1)+omega1_3.^2.*cos(theta1_3).*sin(theta1_1)+omega1_1.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_3.^2.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_1.*omega1_3.*cos(theta1_1).*sin(theta1_3).*2.0-omega1_2.*omega1_3.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3).*2.0+omega1_1.*omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3).*2.0+omega1_1.*omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2).*2.0)+(omega1_1.*cos(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1)-omega1_2.*cos(theta1_1).*cos(theta1_2).*cos(theta1_3)+omega1_1.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2)+omega1_3.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3));
et101 = cos(theta1_2).*sin(theta1_1).*(omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+omega1_2.^2.*cos(theta1_1).*cos(theta1_2)-omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0)-omega1_2.*sin(theta1_1).*sin(theta1_2).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2))+omega1_1.*cos(theta1_1).*cos(theta1_2).*(omega1_1.*cos(theta1_2).*sin(theta1_1)+omega1_2.*cos(theta1_1).*sin(theta1_2));
et102 = (I1z.*cos(theta1_1).*cos(theta1_2).*sin(theta1_2)+I1x.*cos(theta1_2).*cos(theta1_3).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))-I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))).*(et88+et89+et90)+((omega1_2.*cos(theta1_3).*sin(theta1_2)+omega1_3.*cos(theta1_2).*sin(theta1_3)).*(sin(theta1_1).*sin(theta1_3)-cos(theta1_1).*cos(theta1_3).*sin(theta1_2))+(omega1_3.*cos(theta1_2).*cos(theta1_3)-omega1_2.*sin(theta1_2).*sin(theta1_3)).*(cos(theta1_3).*sin(theta1_1)+cos(theta1_1).*sin(theta1_2).*sin(theta1_3))-omega1_2.*cos(theta1_1).*cos(theta1_2).^2).*(et91+et92+et93);
et103 = -(-sin(theta1_2).*(omega1_1.*cos(theta1_1).*cos(theta1_2)-omega1_2.*sin(theta1_1).*sin(theta1_2))+cos(theta1_2).*cos(theta1_3).*(omega1_3.*cos(theta1_1).*cos(theta1_3)-omega1_1.*sin(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*cos(theta1_3).*sin(theta1_2)+omega1_2.*cos(theta1_2).*cos(theta1_3).*sin(theta1_1)-omega1_3.*sin(theta1_1).*sin(theta1_2).*sin(theta1_3))+cos(theta1_2).*sin(theta1_3).*(omega1_1.*cos(theta1_3).*sin(theta1_1)+omega1_3.*cos(theta1_1).*sin(theta1_3)+omega1_1.*cos(theta1_1).*sin(theta1_2).*sin(theta1_3)+omega1_2.*cos(theta1_2).*sin(theta1_1).*sin(theta1_3)+omega1_3.*cos(theta1_3).*sin(theta1_1).*sin(theta1_2))).*(et94+et95+et96)-(I1z.*cos(theta1_2).*sin(theta1_1).*sin(theta1_2)-I1x.*cos(theta1_2).*cos(theta1_3).*(cos(theta1_1).*sin(theta1_3)+cos(theta1_3).*sin(theta1_1).*sin(theta1_2))+I1y.*cos(theta1_2).*sin(theta1_3).*(cos(theta1_1).*cos(theta1_3)-sin(theta1_1).*sin(theta1_2).*sin(theta1_3))).*(et97+et98);
et104 = -(I1z.*sin(theta1_2).^2+I1x.*cos(theta1_2).^2.*cos(theta1_3).^2+I1y.*cos(theta1_2).^2.*sin(theta1_3).^2).*(et99+et100+et101)-m2.*(l1.*cos(theta1_2).*sin(theta1_1)-lg1.*cos(theta1_2).*sin(theta1_1)).*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+lg2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+lg2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-lg2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0)+m2.*(l1.*cos(theta1_1).*cos(theta1_2)-lg1.*cos(theta1_1).*cos(theta1_2)).*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+lg2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+lg2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+lg2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0);
et105 = -lg1.*cos(theta1_2).*sin(theta1_1).*(m1.*(conj(seg1_top_a_3)+lg1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+lg1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)-lg1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0)+m2.*(conj(seg1_top_a_3)+l1.*omega1_1.^2.*cos(theta1_1).*cos(theta1_2)+l1.*omega1_2.^2.*cos(theta1_1).*cos(theta1_2)+lg2.*omega2_1.^2.*cos(theta2_1).*cos(theta2_2)+lg2.*omega2_2.^2.*cos(theta2_1).*cos(theta2_2)-l1.*omega1_1.*omega1_2.*sin(theta1_1).*sin(theta1_2).*2.0-lg2.*omega2_1.*omega2_2.*sin(theta2_1).*sin(theta2_2).*2.0));
et106 = lg1.*cos(theta1_1).*cos(theta1_2).*(m1.*(-conj(seg1_top_a_2)+lg1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+lg1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+lg1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0)+m2.*(-conj(seg1_top_a_2)+l1.*omega1_1.^2.*cos(theta1_2).*sin(theta1_1)+l1.*omega1_2.^2.*cos(theta1_2).*sin(theta1_1)+lg2.*omega2_1.^2.*cos(theta2_2).*sin(theta2_1)+lg2.*omega2_2.^2.*cos(theta2_2).*sin(theta2_1)+l1.*omega1_1.*omega1_2.*cos(theta1_1).*sin(theta1_2).*2.0+lg2.*omega2_1.*omega2_2.*cos(theta2_1).*sin(theta2_2).*2.0));
V_hirashima = [et102+et103+et104+et105+et106;et84+et85+et86+et87;et66+et67+et68+et69;et49+et50+et51;et32+et33+et34;et15+et16+et17];
